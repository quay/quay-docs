:_content-type: CONCEPT
[id="config-updates-38"]
== Configuration updates for Quay 3.8

[id="new-configuration-fields-38"]
=== New configuration fields

The following configuration fields have been introduced with {productname} 3.8: 

[options="header"]
|=== 

|Field | Type |Description 
| xref:enabling-ui-v2[**FEATURE_UI_V2**] | Boolean | When set, allows users to try the beta UI environment. 

*Default:* `True`

| xref:enabling-ipv6-dual-stack[**FEATURE_LISTEN_IP_VERSION**] | String | Enables IPv4, IPv6, or dual-stack protocol family. This configuration field must be properly set, otherwise {productname} fails to start. 

*Default:* `IPv4`

*Additional configurations:* `IPv6`, `dual-stack`

| xref:enabling-ldap-super-users[**LDAP_SUPERUSER_FILTER**] | String | Subset of the `LDAP_USER_FILTER` configuration field. When configured, allows {productname} administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as superusers when {productname} uses LDAP as its authentication provider.

With this field, administrators can add or remove superusers without having to update the {productname} configuration file and restart their deployment. 

| xref:enabling-ldap-restricted-users[**LDAP_RESTRICTED_USER_FILTER**] | String | Subset of the `LDAP_USER_FILTER` configuration field. When configured, allows {productname} administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as restricted users when {productname} uses LDAP as its authentication provider.

| xref:enabling-superusers-full-access[**FEATURE_SUPERUSERS_FULL_ACCESS**] | Boolean | Grants superusers the ability to read, write, and delete content from other repositories in namespaces that they do not own or have explicit permissions for. 

*Default:* `True` 

| xref:enabling-feature-restricted-users[**FEATURE_RESTRICTED_USERS**] | Boolean | Restricts normal users from reading and writing content and creating organizations.

*Default:* `True` 

| xref:enabling-restricted-users-read-only[**RESTRICTED_USER_READ_ONLY**] | Boolean |  When set, restrict users to read-only operations unless otherwise specified in `RESTRICTED_USERS_WHITELIST`. 

*Default:* `True` 

| xref:enabling-restricted-users-whitelist[**RESTRICTED_USERS_WHITELIST**] | String | When set, specific users can be excluded from the `FEATURE_RESTRICTED_USERS` setting. 

| xref:enabling-global-readonly-super-users[**GLOBAL_READONLY_SUPER_USERS**] | String | When set, grants users of this list read access to all repositories, regardless of whether they are public repositories.  
|=== 

[id="enabling-configuration-fields-38"]
=== Enabling {productname} 3.8 configuration fields. 

Use the following sections to enable new {productname} 3.8 features 


[id="enabling-ui-v2"]
==== Enabling the v2 user interface 

With this feature enabled, you can toggle between the current version of the user interface and the new version of the user interface. 

[IMPORTANT]
====
* This UI is currently in beta and subject to change. In its current state, users can only create, view, and delete organizations, repositories, and image tags. 
* When running {productname} in the old UI, timed-out sessions would require that the user input their password again in the pop-up window. With the new UI, users are returned to the main page and required to input their username and password credentials. This is a known issue and will be fixed in a future version of the new UI. 
* There is a discrepancy in how image manifest sizes are reported between the legacy UI and the new UI. In the legacy UI, image manifests were reported in mebibytes. In the new UI, {productname} uses the standard definition of megabyte (MB) to report image manifest sizes. 
====

.Procedure 

. In your deployment's `config.yaml` file, add the `FEATURE_UI_V2` parameter and set it to `true`, for example: 
+
[source,yaml]
----
---
FEATURE_TEAM_SYNCING: false
FEATURE_UI_V2: true
FEATURE_USER_CREATION: true
---
----

. Log in to your {productname} deployment. 

. In the navigation pane of your {productname} deployment, you are given the option to toggle between *Current UI* and *New UI*. Click the toggle button to set it to new UI, and then click *Use Beta Environment*, for example: 
+
image:38-ui-toggle.png[{productname} 3.8 UI toggle]

[id="creating-new-organization-v2-ui"]
===== Creating a new organization in the {productname} 3.8 beta UI 

.Prerequisites 

* You have toggled your {productname} deployment to use the 3.8 beta UI. 

Use the following procedure to create an organization using the {productname} 3.8 beta UI.

.Procedure 

. Click *Organization* in the navigation pane. 

. Click *Create Organization*.

. Enter an *Organization Name*, for example, `testorg`. 

. Click *Create*. 

Now, your example organization should populate under the *Organizations* page. 

[id="deleting-organization-v2"]
===== Deleting an organization using the {productname} 3.8 beta UI

Use the following procedure to delete an organization using the {productname} 3.8 beta UI.

.Procedure 

. On the *Organizations* page, select the name of the organization you want to delete, for example, `testorg`.

. Click the *More Actions* drop down menu. 

. Click *Delete*. 
+
[NOTE]
====
On the *Delete* page, there is a *Search* input box. With this box, users can search for specific organizations to ensure that they are properly scheduled for deletion. For example, if a user is deleting 10 organizations and they want to ensure that a specific organization was deleted, they can use the *Search* input box to confirm said organization is marked for deletion. 
====

. Confirm that you want to permanently delete the organization by typing *confirm* in the box. 

. Click *Delete*. 

After deletion, you are returned to the *Organizations* page. 

[NOTE]
====
You can delete more than one organization at a time by selecting multiple organizations, and then clicking *More Actions* -> *Delete*. 
====

[id="creating-new-repository-v2"]
===== Creating a new repository using the {productname} 3.8 beta UI

Use the following procedure to create a repository using the {productname} 3.8 beta UI.

.Procedure

. Click *Repositories* on the navigation pane. 

. Click *Create Repository*. 

. Select a namespace, for example, *quayadmin*, and then enter a *Repository name*, for example, `testrepo`. 

. Click *Create*. 

Now, your example repository should populate under the *Repositories* page. 

[id="deleting-repository-v2"]
===== Deleting a repository using the {productname} 3.8 beta UI

.Prerequisites 

* You have created a repository. 

.Procedure

. On the *Repositories* page of the {productname} 3.8 beta UI, click the name of the image you want to delete, for example, `quay/admin/busybox`. 

. Click the *More Actions* drop-down menu. 

. Click *Delete*. 
+
[NOTE]
====
If desired, you could click *Make Public* or *Make Private*. 
====

. Type *confirm* in the box, and then click *Delete*. 

. After deletion, you are returned to the *Repositories* page. 

[id="pushing-image-v2"]
===== Pushing an image to the {productname} 3.8 beta UI

Use the following procedure to push an image to the {productname} 3.8 beta UI.

.Procedure

. Pull a sample image from an external registry: 
+
[source,terminal]
----
$ podman pull busybox
----

. Tag the image:
+
[source,terminal]
----
$ podman tag docker.io/library/busybox quay-server.example.com/quayadmin/busybox:test
----

. Push the image to your {productname} registry:
+
[source,terminal]
----
$ podman push quay-server.example.com/quayadmin/busybox:test
----

. Navigate to the *Repositories* page on the {productname} UI and ensure that your image has been properly pushed. 

. You can check the security details by selecting your image tag, and then navigating to the *Security Report* page. 

[id="deleting-image-v2"]
===== Deleting an image using the {productname} 3.8 beta UI

Use the following procedure to delete an image using the{productname} 3.8 beta UI.

.Prerequisites 

* You have pushed an image to your {productname} registry. 

.Procedure 

. On the *Repositories* page of the {productname} 3.8 beta UI, click the name of the image you want to delete, for example, `quay/admin/busybox`. 

. Click the *More Actions* drop-down menu. 

. Click *Delete*. 
+
[NOTE]
====
If desired, you could click *Make Public* or *Make Private*. 
====

. Type *confirm* in the box, and then click *Delete*. 

. After deletion, you are returned to the *Repositories* page. 

[id="enabling-legacy-ui"]
==== Enabling the {productname} legacy UI

. In the navigation pane of your {productname} deployment, you are given the option to toggle between *Current UI* and *New UI*. Click the toggle button to set it to *Current UI*. 
+
image:38-ui-toggle.png[{productname} 3.8 UI toggle]


[id="enabling-ipv6-dual-stack"]
=== Enabling the FEATURE_LISTEN_IP_VERSION configuration field on standalone {productname} deployments 

Your {productname} deployment can now be served in locations that only support IPv6, such as Telco and Edge environments. Support is also offered for dual-stack networking so your {productname} deployment can listen on IPv4 and IPv6 simultaneously.

[id="enabling-ipv6"]
==== Enabling the IPv6 protocol family

Use the following procedure to enable IPv6 on your standalone {productname} deployment. 

.Prerequisites 

* You have updated {productname} to 3.8.
* Your host and container software platform (Docker, Podman) must be configured to support IPv6. 

.Procedure 

. In your deployment's `config.yaml` file, add the `FEATURE_LISTEN_IP_VERSION` parameter and set it to `IPv6`, for example: 
+
[source,yaml]
----
---
FEATURE_GOOGLE_LOGIN: false
FEATURE_INVITE_ONLY_USER_CREATION: false
FEATURE_LISTEN_IP_VERSION: IPv6
FEATURE_MAILING: false
FEATURE_NONSUPERUSER_TEAM_SYNCING_SETUP: false
---
----

. Start, or restart, your {productname} deployment. 

. Check that your deployment is listening to IPv6. 
+
.. For a standalone deployment, enter the following command:
+
[source,terminal]
----
$ curl <quay_endpoint>/health/instance
{"data":{"services":{"auth":true,"database":true,"disk_space":true,"registry_gunicorn":true,"service_key":true,"web_gunicorn":true}},"status_code":200}
----

After enabling IPv6 in your deployment's `config.yaml`, all {productname} features can be used as normal, so long as your environment is configured to use IPv6 and is not hindered by the ipv6-limitations[current limitations]. 

[WARNING]
====
If your environment is configured to IPv4, but the `FEATURE_LISTEN_IP_VERSION` configuration field is set to `IPv6`, {productname} will fail to deploy. 
====

[id="enabling-dual-stack"]
==== Enabling the dual-stack protocol family

.Prerequisites 

* You have updated {productname} to 3.8.
* Your host and container software platform (Docker, Podman) must be configured to support IPv6. 

.Procedure

. In your deployment's `config.yaml` file, add the `FEATURE_LISTEN_IP_VERSION` parameter and set it to `dual-stack`, for example: 
+
[source,yaml]
----
---
FEATURE_GOOGLE_LOGIN: false
FEATURE_INVITE_ONLY_USER_CREATION: false
FEATURE_LISTEN_IP_VERSION: dual-stack
FEATURE_MAILING: false
FEATURE_NONSUPERUSER_TEAM_SYNCING_SETUP: false
---
----

. Start, or restart, your {productname} deployment. 

. Check that your deployment is listening to both channels by entering the following command:
.. For IPv4, enter the following command:
+
[source,terminal]
----
$ curl --ipv4 <quay_endpoint>
{"data":{"services":{"auth":true,"database":true,"disk_space":true,"registry_gunicorn":true,"service_key":true,"web_gunicorn":true}},"status_code":200}
----
.. For IPv6, enter the following command:
+
[source,terminal]
----
$ curl --ipv6 <quay_endpoint> 
{"data":{"services":{"auth":true,"database":true,"disk_space":true,"registry_gunicorn":true,"service_key":true,"web_gunicorn":true}},"status_code":200}
----

After enabling dual-stack in your deployment's `config.yaml`, all {productname} features can be used as normal, so long as your environment is configured for dual-stack. 


[id="enabling-ldap-super-users"]
=== Enabling the LDAP_SUPERUSER_FILTER configuration field

The `LDAP_SUPERUSER_FILTER` configuration field is now available. With this field configured, {productname} administrators can configure Lightweight Directory Access Protocol (LDAP) users as superusers if {productname} uses LDAP as its authentication provider. 

Use the following procedure to enable LDAP superusers on your {productname} deployment. 

.Prerequisites 

* Your {productname} deployment uses LDAP as its authentication provider. 
* You have configured the `LDAP_USER_FILTER` field. 

.Procedure 

. In your deployment's `config.yaml` file, add the `LDAP_SUPERUSER_FILTER` parameter and add the group of users you want configured as super users, for example, `root`: 
+
[source,yaml]
----
LDAP_ADMIN_DN: uid=<name>,ou=Users,o=<organization_id>,dc=<example_domain_component>,dc=com
LDAP_ADMIN_PASSWD: ABC123
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=<organization_id>
    - dc=<example_domain_component>
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://<example_url>.com
LDAP_USER_FILTER: (memberof=cn=developers,ou=Users,o=<example_organization_unit>,dc=<example_domain_component>,dc=com)
LDAP_SUPERUSER_FILTER: (<filterField>=<value>)
LDAP_USER_RDN:
    - ou=<example_organization_unit>
    - o=<organization_id>
    - dc=<example_domain_component>
    - dc=com
----

. Start, or restart, your {productname} deployment. 

After enabling the `LDAP_SUPERUSER_FILTER` feature, your LDAP {productname} users have superuser privileges. The following options are available to superusers:

* Manage users
* Manage organizations
* Manage service keys
* View the change log
* Query the usage logs
* Create globally visible user messages 


[id="enabling-ldap-restricted-users"]
=== Enabling the LDAP_RESTRICTED_USER_FILTER configuration field

The `LDAP_RESTRICTED_USER_FILTER` is now available. This configuration field is a subset of the `LDAP_USER_FILTER` configuration field. When configured, allows {productname} administrators the ability to configure Lightweight Directory Access Protocol (LDAP) users as restricted users when {productname} uses LDAP as its authentication provider.

Use the following procedure to enable LDAP restricted users on your {productname} deployment. 

.Prerequisites 

* Your {productname} deployment uses LDAP as its authentication provider. 
* You have configured the `LDAP_USER_FILTER` field. 

.Procedure 

. In your deployment's `config.yaml` file, add the `LDAP_RESTRICTED_USER_FILTER` parameter and specify the group of restricted users, for example, `members`:  
+
[source,yaml]
----
LDAP_ADMIN_DN: uid=<name>,ou=Users,o=<organization_id>,dc=<example_domain_component>,dc=com
LDAP_ADMIN_PASSWD: ABC123
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=<organization_id>
    - dc=<example_domain_component>
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://<example_url>.com
LDAP_USER_FILTER: (memberof=cn=developers,ou=Users,o=<example_organization_unit>,dc=<example_domain_component>,dc=com)
LDAP_RESTRICTED_USER_FILTER: (<filterField>=<value>)
LDAP_USER_RDN:
    - ou=<example_organization_unit>
    - o=<organization_id>
    - dc=<example_domain_component>
    - dc=com
----

. Start, or restart, your {productname} deployment. 

After enabling the `LDAP_RESTRICTED_USER_FILTER` feature, your LDAP {productname} users are restricted from reading and writing content, and creating organizations. 

[id="enabling-superusers-full-access"]
=== Enabling the FEATURE_SUPERUSERS_FULL_ACCESS configuration field

The `FEATURE_SUPERUSERS_FULL_ACCESS` feature is now available. This configuration field grants superusers the ability to read, write, and delete content from other repositories in namespaces that they do not own or have explicit permissions for. 

[NOTE]
====
* This feature is only available on the beta of the new UI. When enabled, it shows all organizations that the super user has access to. To enable the beta of the new UI, see xref:enabling-ui-v2[FEATURE_UI_V2]
* When this field is enabled, the superuser cannot view the image repository of every organization at once. This is a known limitation and will be fixed in a future version of {productname}. As a temporary workaround, the superuser can view image repositories from the *Organizations* page. 
====

Use the following procedure to enable the `FEATURE_SUPERUSERS_FULL_ACCESS` feature on your {productname} deployment. 

.Prerequisites 

* You have defined the `SUPER_USERS` configuration field in your `config.yaml` file. 

.Procedure 

. In your deployment's `config.yaml` file, add the `FEATURE_SUPERUSERS_FULL_ACCESS` parameter and set it to `true`, for example: 
+
[source,yaml]
----
---
SUPER_USERS:
- quayadmin
FEATURE_SUPERUSERS_FULL_ACCESS: True
---
----

. Start, or restart, your {productname} deployment. 

With this feature enabled, your deployment's superusers can read, write, and delete content from other repositories in namespaces that they do not own. 

[id="enabling-feature-restricted-users"]
=== Enabling the FEATURE_RESTRICTED_USERS configuration field

The `FEATURE_RESTRICTED_USERS` configuration field is now available. When configured, normal users are made incapable of creating new organizations. 

Using the following procedure to enable the `FEATURE_RESTRICTED_USERS` feature on your {productname} deployment.  

.Procedure 

. In your deployment's `config.yaml` file, add the `FEATURE_RESTRICTED_USERS` parameter and set it to `true`, for example: 
+
[source,yaml]
----
---
FEATURE_RESTRICTED_USERS: true
---
----

. Start, or restart, your {productname} deployment. 

Now, normal users attempting to create an organization results in an `Unauthorized` error. 

[id="enabling-restricted-users-read-only"]
=== Enabling the `RESTRICTED_USER_READ_ONLY` configuration field

The `RESTRICTED_USER_READ_ONLY` configuration field is now available. This configuration field is a subset of the `FEATURE_RESTRICTED_USERS` field. When set to `true`, `RESTRICTED_USER_READ_ONLY` restricts normal users to read-only operations.

Use the following procedure to enable `FEATURE_RESTRICTED_USERS`. 

.Prerequisites 

* `FEATURE_RESTRICTED_USERS` is set to `true` in your `config.yaml`. 

.Procedure

. In your deployment's `config.yaml` file, add the `RESTRICTED_USER_READ_ONLY` parameter set it to `true`:
+
[source,yaml]
----
FEATURE_RESTRICTED_USERS: true
RESTRICTED_USER_READ_ONLY: true
----

. Start, or restart, your {productname} deployment. 

Now, normal users are only able to perform read-only operations. 

[id="enabling-restricted-users-whitelist"]
=== Enabling the `RESTRICTED_USERS_WHITELIST` configuration field

The `RESTRICTED_USERS_WHITELIST` configuration field is now available. When configured, specified users are excluded from the `FEATURE_RESTRICTED_USERS` and `RESTRICTED_USER_READ_ONLY` configurations.

 Use the following procedure to exclude users from the `FEATURE_RESTRICTED_USERS` and `RESTRICTED_USER_READ_ONLY` settings so that they can have `read` and `write` privileges. 

.Prerequisites 

* `FEATURE_RESTRICTED_USERS` is set to `true` in your `config.yaml`. 
* `RESTRICTED_USER_READ_ONLY` is set to `true` in your `config.yaml`. 

.Procedure

. In your deployment's `config.yaml` file, add the `RESTRICTED_USERS_WHITELIST` parameter and a user, for example, `user1`:
+
[source,yaml]
----
FEATURE_RESTRICTED_USERS: true
RESTRICTED_USERS_WHITELIST:
      - user1
----

. Start, or restart, your {productname} deployment. 

With this feature enabled, whitelisted users can create organizations, or read or write content from the repository even if `FEATURE_RESTRICTED_USERS` and `RESTRICTED_USERS_WHITELIST` are set to `true`. 

[id="enabling-global-readonly-super-users"]
=== Enabling the `GLOBAL_READONLY_SUPER_USERS` configuration field

The `GLOBAL_READONLY_SUPER_USERS` is now available. When configured, grants users of this list read access to all repositories, regardless of whether they are public repositories. 

Use the following procedure to add users to the `GLOBAL_READONLY_SUPER_USERS` configuration field. 

.Procedure

. In your deployment's `config.yaml` file, add the `GLOBAL_READONLY_SUPER_USERS` and a user, for example, `user1`: 
+
[source,yaml]
----
GLOBAL_READONLY_SUPER_USERS:
      - user1
----

. Start, or restart, your {productname} deployment. 

With this feature enabled, defined users are given access to view and pull content from all repositories. 
name: Cherry Pick on Comment

on:
  issue_comment:
    types: [created]

jobs:
  cherry_pick:
    runs-on: ubuntu-latest
    if: ${{ github.event.issue.pull_request && startsWith(github.event.comment.body, '/cherry-pick') }}
    steps:
      - name: Extract branch name from comment
        id: extract_branch
        run: |
          echo "##[set-output name=branch;]$(echo "${{ github.event.comment.body }}" | sed -n 's/\/cherry-pick //p')"
      - name: Checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Cherry pick commit
        uses: carloscastrojumo/github-cherry-pick-action@v1.0.1
        with:
          branch: ${{ steps.extract_branch.outputs.branch }}
          labels: |
            cherry-pick
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

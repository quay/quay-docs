<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Configure Red Hat Quay</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.4"/><meta name="description" content="Configure Red Hat Quay"/><link rel="next" href="#config-intro" title="Chapter 1. Getting started with configuration"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm45162234660592"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Quay</span> <span class="productnumber">3.7</span></div><div><h1 class="title">Configure Red Hat Quay</h1></div><div><h2 class="subtitle">Customizing Red Hat Quay using configuration options</h2></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat OpenShift Documentation Team</span></div></div><div><a href="#idm45162230260800">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Configure Red Hat Quay
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="chapter"><a href="#config-intro">1. Getting started with configuration</a></span><ul><li><span class="section"><a href="#config-updates-36">1.1. Configuration updates for Quay 3.6</a></span><ul><li><span class="section"><a href="#new_configuration_fields">1.1.1. New configuration fields</a></span></li><li><span class="section"><a href="#deprecated_configuration_fields">1.1.2. Deprecated configuration fields</a></span></li></ul></li><li><span class="section"><a href="#editing_the_configuration_file">1.2. Editing the configuration file</a></span></li><li><span class="section"><a href="#location_of_configuration_file_in_a_standalone_deployment">1.3. Location of configuration file in a standalone deployment</a></span></li><li><span class="section"><a href="#config-file-minimal">1.4. Minimal configuration</a></span><ul><li><span class="section"><a href="#sample_minimal_configuration_file">1.4.1. Sample minimal configuration file</a></span></li><li><span class="section"><a href="#local_storage">1.4.2. Local storage</a></span></li><li><span class="section"><a href="#cloud_storage">1.4.3. Cloud storage</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#config-fields-intro">2. Configuration fields</a></span><ul><li><span class="section"><a href="#config-fields-required-intro">2.1. Required configuration fields</a></span></li><li><span class="section"><a href="#config-preconfigure-automation-intro">2.2. Automation options</a></span></li><li><span class="section"><a href="#config-fields-optional-intro">2.3. Optional configuration fields</a></span></li><li><span class="section"><a href="#config-fields-required-general">2.4. General required fields</a></span></li><li><span class="section"><a href="#config-fields-db">2.5. Database configuration</a></span><ul><li><span class="section"><a href="#database_uri">2.5.1. Database URI</a></span></li><li><span class="section"><a href="#database_connection_arguments">2.5.2. Database connection arguments</a></span></li></ul></li><li><span class="section"><a href="#config-fields-storage">2.6. Image storage</a></span><ul><li><span class="section"><a href="#config-fields-storage-features">2.6.1. Image storage features</a></span></li><li><span class="section"><a href="#config-fields-storage-fields">2.6.2. Image storage configuration fields</a></span></li><li><span class="section"><a href="#config-fields-storage-local">2.6.3. Local storage</a></span></li><li><span class="section"><a href="#config-fields-storage-noobaa">2.6.4. OCS/NooBaa</a></span></li><li><span class="section"><a href="#config-fields-storage-rados">2.6.5. Ceph / RadosGW Storage / Hitachi HCP</a></span></li><li><span class="section"><a href="#config-fields-storage-aws">2.6.6. AWS S3 storage</a></span></li><li><span class="section"><a href="#config-fields-storage-gcp">2.6.7. Google cloud storage</a></span></li><li><span class="section"><a href="#config-fields-storage-azure">2.6.8. Azure storage</a></span></li><li><span class="section"><a href="#config-fields-storage-swift">2.6.9. Swift storage</a></span></li></ul></li><li><span class="section"><a href="#config-fields-redis">2.7. Redis configuration fields</a></span><ul><li><span class="section"><a href="#build_logs">2.7.1. Build logs</a></span></li><li><span class="section"><a href="#user_events">2.7.2. User events</a></span></li><li><span class="section"><a href="#example_redis_configuration">2.7.3. Example redis configuration</a></span></li></ul></li><li><span class="section"><a href="#config-fields-tag-expiration">2.8. Tag expiration options</a></span></li><li><span class="section"><a href="#config-preconfigure-automation">2.9. Pre-configuring Quay for automation</a></span><ul><li><span class="section"><a href="#allowing_the_api_to_create_the_first_user">2.9.1. Allowing the API to create the first user</a></span></li><li><span class="section"><a href="#enabling_general_api_access">2.9.2. Enabling general API access</a></span></li><li><span class="section"><a href="#adding_a_super_user">2.9.3. Adding a super user</a></span></li><li><span class="section"><a href="#restricting_user_creation">2.9.4. Restricting user creation</a></span></li><li><span class="section"><a href="#suggested_configuration_for_automation">2.9.5. Suggested configuration for automation</a></span></li><li><span class="section"><a href="#deploying_the_operator_using_the_initial_configuration">2.9.6. Deploying the Operator using the initial configuration</a></span></li><li><span class="section"><a href="#first-user-api">2.9.7. Using the API to create the first user</a></span></li></ul></li><li><span class="section"><a href="#config-fields-basic">2.10. Basic configuration</a></span></li><li><span class="section"><a href="#config-fields-ssl">2.11. SSL configuration fields</a></span><ul><li><span class="section"><a href="#configuring_ssl">2.11.1. Configuring SSL</a></span></li></ul></li><li><span class="section"><a href="#config-custom-ssl-certs-manual">2.12. Adding TLS Certificates to the Red Hat Quay Container</a></span><ul><li><span class="section"><a href="#add-certificates-to-quay-container">2.12.1. Add TLS certificates to Red Hat Quay</a></span></li></ul></li><li><span class="section"><a href="#config-fields-ldap">2.13. LDAP configuration fields</a></span><ul><li><span class="section"><a href="#ldap_configuration_example">2.13.1. LDAP configuration example</a></span></li></ul></li><li><span class="section"><a href="#config-fields-mirroring">2.14. Mirroring configuration fields</a></span></li><li><span class="section"><a href="#config-fields-scanner">2.15. Security scanner configuration fields</a></span></li><li><span class="section"><a href="#config-fields-helm-oci">2.16. OCI and Helm configuration</a></span></li><li><span class="section"><a href="#config-fields-actionlog">2.17. Action log configuration fields</a></span><ul><li><span class="section"><a href="#action_log_storage_configuration">2.17.1. Action log storage configuration</a></span></li><li><span class="section"><a href="#action_log_rotation_and_archiving_configuration">2.17.2. Action log rotation and archiving configuration</a></span></li></ul></li><li><span class="section"><a href="#config-fields-build-logs">2.18. Build logs</a></span></li><li><span class="section"><a href="#config-fields-dockerfile-build">2.19. Dockerfile build triggers fields</a></span><ul><li><span class="section"><a href="#github_build_triggers">2.19.1. GitHub build triggers</a></span></li><li><span class="section"><a href="#bitbucket_build_triggers">2.19.2. BitBucket build triggers</a></span></li><li><span class="section"><a href="#gitlab_build_triggers">2.19.3. GitLab build triggers</a></span></li></ul></li><li><span class="section"><a href="#config-fields-oauth">2.20. OAuth configuration</a></span><ul><li><span class="section"><a href="#github_oauth">2.20.1. GitHub OAuth</a></span></li><li><span class="section"><a href="#google_oauth">2.20.2. Google OAuth</a></span></li></ul></li><li><span class="section"><a href="#config-fields-nested-repositories">2.21. Configuring nested repositories</a></span></li><li><span class="section"><a href="#other-oci-artifacts-with-quay">2.22. Adding other OCI media types to Quay</a></span></li><li><span class="section"><a href="#config-fields-mail">2.23. Mail configuration</a></span></li><li><span class="section"><a href="#config-fields-user">2.24. User configuration fields</a></span></li><li><span class="section"><a href="#config-fields-recaptcha">2.25. Recaptcha configuration</a></span></li><li><span class="section"><a href="#config-fields-aci">2.26. ACI configuration</a></span></li><li><span class="section"><a href="#config-fields-jwt">2.27. JTW configuration</a></span></li><li><span class="section"><a href="#config-fields-app-tokens">2.28. App tokens</a></span></li><li><span class="section"><a href="#config-fields-misc">2.29. Miscellaneous fields</a></span></li><li><span class="section"><a href="#config-fields-legacy">2.30. Legacy configuration fields</a></span></li></ul></li><li><span class="chapter"><a href="#config-envar-intro">3. Environment variables</a></span><ul><li><span class="section"><a href="#config-envvar-georepl">3.1. Geo-replication</a></span></li><li><span class="section"><a href="#config-envvar-dbpool">3.2. Database connection pooling</a></span></li><li><span class="section"><a href="#config-envvar-worker-connection">3.3. HTTP connection counts</a></span></li><li><span class="section"><a href="#config-envvar-worker-count">3.4. Worker count variables</a></span></li></ul></li><li><span class="chapter"><a href="#operator-config-ui">4. Using the config tool to reconfigure Quay on OpenShift</a></span><ul><li><span class="section"><a href="#operator-config-ui-access">4.1. Accessing the config editor</a></span><ul><li><span class="section"><a href="#retrieving_the_config_editor_credentials">4.1.1. Retrieving the config editor credentials</a></span></li><li><span class="section"><a href="#logging_in_to_the_config_editor">4.1.2. Logging in to the config editor</a></span></li><li><span class="section"><a href="#operator-config-ui-change">4.1.3. Changing configuration</a></span></li></ul></li><li><span class="section"><a href="#operator-config-ui-monitoring">4.2. Monitoring reconfiguration in the UI</a></span><ul><li><span class="section"><a href="#quayregistry_resource">4.2.1. QuayRegistry resource</a></span></li><li><span class="section"><a href="#events">4.2.2. Events</a></span></li></ul></li><li><span class="section"><a href="#operator-config-ui-updated">4.3. Accessing updated information after reconfiguration</a></span><ul><li><span class="section"><a href="#accessing_the_updated_config_tool_credentials_in_the_ui">4.3.1. Accessing the updated config tool credentials in the UI</a></span></li><li><span class="section"><a href="#accessing_the_updated_config_yaml_in_the_ui">4.3.2. Accessing the updated config.yaml in the UI</a></span></li></ul></li></ul></li><li><span class="chapter"><a href="#operator-components-intro">5. Quay Operator components</a></span><ul><li><span class="section"><a href="#operator-components-managed">5.1. Using managed components</a></span></li><li><span class="section"><a href="#operator-components-unmanaged">5.2. Using unmanaged components for dependencies</a></span><ul><li><span class="section"><a href="#operator-unmanaged-postgres">5.2.1. Using an existing Postgres database</a></span></li><li><span class="section"><a href="#operator-unmanaged-storage-noobaa">5.2.2. NooBaa unmanaged storage</a></span></li><li><span class="section"><a href="#operator-unmanaged-hpa">5.2.3. Disabling the Horizontal Pod Autoscaler</a></span></li></ul></li><li><span class="section"><a href="#config-custom-ssl-cert-kubernetes">5.3. Add certs when deployed on Kubernetes</a></span></li><li><span class="section"><a href="#operator-helm-oci">5.4. Configuring OCI and Helm with the Operator</a></span></li><li><span class="section"><a href="#operator-volume-size-overrides">5.5. Volume size overrides</a></span></li></ul></li><li><span class="chapter"><a href="#using_the_configuration_api">6. Using the configuration API</a></span><ul><li><span class="section"><a href="#retrieving_the_default_configuration">6.1. Retrieving the default configuration</a></span></li><li><span class="section"><a href="#retrieving_the_current_configuration">6.2. Retrieving the current configuration</a></span></li><li><span class="section"><a href="#validating_configuration_using_the_api">6.3. Validating configuration using the API</a></span></li><li><span class="section"><a href="#determining_the_required_fields">6.4. Determining the required fields</a></span></li></ul></li><li><span class="chapter"><a href="#using_the_configuration_tool">7. Using the configuration tool</a></span><ul><li><span class="section"><a href="#config-ui-custom-ssl-certs">7.1. Custom SSL certificates UI</a></span></li><li><span class="section"><a href="#config-ui-basic-config">7.2. Basic configuration</a></span><ul><li><span class="section"><a href="#contact_information">7.2.1. Contact information</a></span></li></ul></li><li><span class="section"><a href="#config-ui-server-config">7.3. Server configuration</a></span><ul><li><span class="section"><a href="#server_configuration_choice">7.3.1. Server configuration choice</a></span></li><li><span class="section"><a href="#tls_configuration">7.3.2. TLS configuration</a></span></li></ul></li><li><span class="section"><a href="#config-ui-database">7.4. Database configuration</a></span><ul><li><span class="section"><a href="#postgresql_configuration">7.4.1. PostgreSQL configuration</a></span></li></ul></li><li><span class="section"><a href="#config-ui-data-consistency">7.5. Data consistency</a></span></li><li><span class="section"><a href="#config-ui-time-machine">7.6. Time machine configuration</a></span></li><li><span class="section"><a href="#config-ui-redis">7.7. Redis configuration</a></span></li><li><span class="section"><a href="#config-ui-repo-mirroring">7.8. Repository mirroring configuration</a></span></li><li><span class="section"><a href="#config-ui-storage">7.9. Registry storage configuration</a></span><ul><li><span class="section"><a href="#config-ui-storage-georepl">7.9.1. Enable storage replication - standalone Quay</a></span></li><li><span class="section"><a href="#config-ui-storage-engines">7.9.2. Storage engines</a></span></li></ul></li><li><span class="section"><a href="#config-ui-action-log">7.10. Action log configuration</a></span><ul><li><span class="section"><a href="#action_log_storage_configuration_2">7.10.1. Action log storage configuration</a></span></li><li><span class="section"><a href="#action_log_rotation_and_archiving">7.10.2. Action log rotation and archiving</a></span></li></ul></li><li><span class="section"><a href="#config-ui-security-scanner">7.11. Security scanner configuration</a></span></li><li><span class="section"><a href="#config-ui-app-registry">7.12. Application registry configuration</a></span></li><li><span class="section"><a href="#config-ui-email">7.13. Email configuration</a></span></li><li><span class="section"><a href="#config-ui-internal-authentication">7.14. Internal authentication configuration</a></span><ul><li><span class="section"><a href="#ldap">7.14.1. LDAP</a></span></li><li><span class="section"><a href="#keystone_openstack_identity">7.14.2. Keystone (OpenStack identity)</a></span></li><li><span class="section"><a href="#jwt_custom_authentication">7.14.3. JWT custom authentication</a></span></li><li><span class="section"><a href="#external_application_token">7.14.4. External application token</a></span></li></ul></li><li><span class="section"><a href="#config-ui-oauth">7.15. External authentication (OAUTH) configuration</a></span><ul><li><span class="section"><a href="#github_enterprise_authentication">7.15.1. GitHub (Enterprise) authentication</a></span></li><li><span class="section"><a href="#google_authentication">7.15.2. Google authentication</a></span></li></ul></li><li><span class="section"><a href="#config-ui-access-settings">7.16. Access settings configuration</a></span></li><li><span class="section"><a href="#config-ui-dockerfile-build">7.17. Dockerfile build support</a></span><ul><li><span class="section"><a href="#github_enterprise_build_triggers">7.17.1. GitHub (Enterprise) Build Triggers</a></span></li><li><span class="section"><a href="#bitbucket_build_triggers_2">7.17.2. BitBucket Build Triggers</a></span></li><li><span class="section"><a href="#gitlab_build_triggers_2">7.17.3. GitLab Build Triggers</a></span></li></ul></li></ul></li></ul></div><section class="chapter" id="config-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 1. Getting started with configuration</h1></div></div></div><p>
			Red Hat Quay can be deployed in a standalone manner, or on an existing OpenShift cluster using the Operator. The methods you use to create, retrieve, update and validate the Red Hat Quay configuration vary slightly, depending on the type of deployment you are using. However, the core configuration options are fundamentally the same for all types of deployment, and these options can be manipulated:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Directly, by editing the <code class="literal">config.yaml</code> file. See the section <a class="link" href="#editing_the_configuration_file" title="1.2. Editing the configuration file">Editing the configuration file</a>.
				</li><li class="listitem">
					Programmatically, using the configuration API. See the section <a class="link" href="#using_the_configuration_api" title="Chapter 6. Using the configuration API">Using the configuration API</a>.
				</li><li class="listitem">
					Visually, using the configuration tool UI. See the section <a class="link" href="#using_the_configuration_tool" title="Chapter 7. Using the configuration tool">Using the configuration tool</a>.
				</li></ul></div><p>
			You can install Quay on OpenShift using the Operator, without the need to supply any initial configuration, as the Operator will supply sensible defaults to deploy the registry. For a standalone deployment, however, you must supply a minimal level of configuration before the registry can be started. The minimal requirements can be determined using the <a class="link" href="#retrieving_the_current_configuration" title="6.2. Retrieving the current configuration">configuration API</a> and are documented in the section
		</p><p>
			Once you have Quay deployed with your initial configuration, you should retrieve and save the full configuration from the running system as it may contain extra, generated values that you will need in future when restarting or upgrading your system.
		</p><section class="section" id="config-updates-36"><div class="titlepage"><div><div><h2 class="title">1.1. Configuration updates for Quay 3.6</h2></div></div></div><section class="section" id="new_configuration_fields"><div class="titlepage"><div><div><h3 class="title">1.1.1. New configuration fields</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>FEATURE_EXTENDED_REPOSITORY_NAMES:</strong></span> Support for nested repositories and extended repository names has been added. This change allows the use of <code class="literal">/</code> in repository names needed for certain OpenShift Container Platform use cases. For more information, see <a class="link" href="#config-fields-nested-repositories" title="2.21. Configuring nested repositories">Configuring nested repositories</a>
						</li><li class="listitem">
							<span class="strong strong"><strong>FEATURE_USER_INITIALIZE:</strong></span> If set to true, the first User account may be created via API <code class="literal">/api/v1/user/initialize</code>. For more information, see <a class="link" href="#config-preconfigure-automation" title="2.9. Pre-configuring Quay for automation">Pre-configuring Quay for automation</a>
						</li><li class="listitem">
							<span class="strong strong"><strong>ALLOWED_OCI_ARTIFACT_TYPES:</strong></span> Helm, cosign, and ztsd compression scheme artifacts are built into Red Hat Quay 3.7 by default. For any other OCI media type that is not supported by default, you can add them to the <code class="literal">ALLOWED_OCI_ARTIFACT_TYPES</code> configuration in Quay’s <code class="literal">config.yaml</code> For more information, see <a class="link" href="#other-oci-artifacts-with-quay" title="2.22. Adding other OCI media types to Quay">Adding other OCI media types to Quay</a>
						</li><li class="listitem">
							<span class="strong strong"><strong>CREATE_PRIVATE_REPO_ON_PUSH:</strong></span> Registry users now have the option to set <code class="literal">CREATE_PRIVATE_REPO_ON_PUSH</code> in their config.yaml to <code class="literal">True</code> or <code class="literal">False</code> depending on their security needs.
						</li><li class="listitem">
							<span class="strong strong"><strong>CREATE_NAMESPACE_ON_PUSH:</strong></span> Pushing to a non-existent organization can now be configured to automatically create the organization.
						</li></ul></div></section><section class="section" id="deprecated_configuration_fields"><div class="titlepage"><div><div><h3 class="title">1.1.2. Deprecated configuration fields</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>FEATURE_HELM_OCI_SUPPORT</strong></span>: This option has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.7, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their config.yaml files to enable support.
						</li></ul></div></section></section><section class="section" id="editing_the_configuration_file"><div class="titlepage"><div><div><h2 class="title">1.2. Editing the configuration file</h2></div></div></div><p>
				Deploying the registry in standalone mode requires a minimal configuration - see section <a class="xref" href="#config-file-minimal" title="1.4. Minimal configuration">Section 1.4, “Minimal configuration”</a>.
			</p><p>
				The configuration file is validated on startup of the registry, and any issue will be highlighted in the output:
			</p><p>
				It is possible to use the configuration API to validate the configuration, but this requires starting the Quay container in config mode
			</p><p>
				For changes to take effect, the registry needs to be restarted.
			</p></section><section class="section" id="location_of_configuration_file_in_a_standalone_deployment"><div class="titlepage"><div><div><h2 class="title">1.3. Location of configuration file in a standalone deployment</h2></div></div></div><p>
				For a standalone deployment, the <code class="literal">config.yaml</code> file must be specified when starting the Quay registry. This file is located in the config volume, so in the following example, the config file is located at <code class="literal">$QUAY/config/config.yaml</code>:
			</p><pre class="literallayout">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   -v $QUAY/storage:/datastorage:Z \
   registry.redhat.io/quay/quay-rhel8:v3.7.0</pre></section><section class="section" id="config-file-minimal"><div class="titlepage"><div><div><h2 class="title">1.4. Minimal configuration</h2></div></div></div><p>
				For a standalone deployment, configuration options are required for the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Server hostname
					</li><li class="listitem">
						HTTP or HTTPS
					</li><li class="listitem">
						Authentication type, for example, Database or LDAP
					</li><li class="listitem">
						Secret keys for encrypting data
					</li><li class="listitem">
						Storage for images
					</li><li class="listitem">
						Database for metadata
					</li><li class="listitem">
						Redis for build logs and user events
					</li><li class="listitem">
						Tag expiration options
					</li></ul></div><section class="section" id="sample_minimal_configuration_file"><div class="titlepage"><div><div><h3 class="title">1.4.1. Sample minimal configuration file</h3></div></div></div><p>
					A sample minimal config file, using local storage for images, is shown below:
				</p><div class="formalpara"><p class="title"><strong>$QUAY/config/config.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">AUTHENTICATION_TYPE: Database
BUILDLOGS_REDIS:
    host: quay-server.example.com
    password: strongpassword
    port: 6379
DATABASE_SECRET_KEY: 0ce4f796-c295-415b-bf9d-b315114704b8
DB_URI: postgresql://quayuser:quaypass@quay-server.example.com:5432/quay
DEFAULT_TAG_EXPIRATION: 2w
DISTRIBUTED_STORAGE_CONFIG:
    default:
        - LocalStorage
        - storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default
PREFERRED_URL_SCHEME: http
SECRET_KEY: e8f9fe68-1f84-48a8-a05f-02d72e6eccba
SERVER_HOSTNAME: quay-server.example.com
SETUP_COMPLETE: true
TAG_EXPIRATION_OPTIONS:
    - 0s
    - 1d
    - 1w
    - 2w
    - 4w
USER_EVENTS_REDIS:
    host: quay-server.example.com
    password: strongpassword
    port: 6379</pre>
					</p></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The <code class="literal">SETUP_COMPLETE</code> field indicates that the configuration has been validated. You should use the config editor tool to validate your configuration before starting the registry.
					</p></div></div></section><section class="section" id="local_storage"><div class="titlepage"><div><div><h3 class="title">1.4.2. Local storage</h3></div></div></div><p>
					Using local storage for images is only recommended when deploying a registry for proof of concept purposes. In this case, storage is specified on the command line when starting the registry, mapping a local directory <code class="literal">$QUAY/storage</code> to the <code class="literal">/datastorage</code> path in the container:
				</p><pre class="literallayout">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   -v $QUAY/storage:/datastorage:Z \
   registry.redhat.io/quay/quay-rhel8:v3.7.0</pre></section><section class="section" id="cloud_storage"><div class="titlepage"><div><div><h3 class="title">1.4.3. Cloud storage</h3></div></div></div><p>
					Storage configuration is detailed in the section <a class="link" href="#config-fields-storage" title="2.6. Image storage">Image storage</a>. It is useful to compare the difference when using cloud storage, for example, on Google Cloud Platform:
				</p><div class="formalpara"><p class="title"><strong>$QUAY/config/config.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
    default:
        - GoogleCloudStorage
        - access_key: GOOGQIMFB3ABCDEFGHIJKLMN
          bucket_name: quay_bucket
          secret_key: FhDAYe2HeuAKfvZCAGyOioNaaRABCDEFGHIJKLMN
          storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre>
					</p></div><p>
					When starting the registry using cloud storage, no configuration is required on the command line:
				</p><pre class="literallayout">$ sudo podman run -d --rm -p 80:8080 -p 443:8443 \
   --name=quay \
   -v $QUAY/config:/conf/stack:Z \
   registry.redhat.io/quay/quay-rhel8:v3.7.0</pre></section></section></section><section class="chapter" id="config-fields-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Configuration fields</h1></div></div></div><section class="section" id="config-fields-required-intro"><div class="titlepage"><div><div><h2 class="title">2.1. Required configuration fields</h2></div></div></div><p>
				Required fields are covered in the following sections:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-fields-required-general" title="2.4. General required fields">General required fields</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-redis" title="2.7. Redis configuration fields">Storage for images</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-db" title="2.5. Database configuration">Database for metadata</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-redis" title="2.7. Redis configuration fields">Redis for build logs and user events</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-tag-expiration" title="2.8. Tag expiration options">Tag expiration options</a>
					</li></ul></div></section><section class="section" id="config-preconfigure-automation-intro"><div class="titlepage"><div><div><h2 class="title">2.2. Automation options</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-preconfigure-automation" title="2.9. Pre-configuring Quay for automation">Pre-configuring Quay for automation</a>
					</li><li class="listitem">
						<a class="link" href="#first-user-api" title="2.9.7. Using the API to create the first user">Using the API to create the first user</a>
					</li></ul></div></section><section class="section" id="config-fields-optional-intro"><div class="titlepage"><div><div><h2 class="title">2.3. Optional configuration fields</h2></div></div></div><p>
				Optional fields are covered in the following sections:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#config-fields-basic" title="2.10. Basic configuration">Basic configuration</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-ssl" title="2.11. SSL configuration fields">SSL</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-ldap" title="2.13. LDAP configuration fields">LDAP</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-mirroring" title="2.14. Mirroring configuration fields">Repository mirroring</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-scanner" title="2.15. Security scanner configuration fields">Security scanner</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-helm-oci" title="2.16. OCI and Helm configuration">OCI and Helm</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-actionlog" title="2.17. Action log configuration fields">Action log</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-build-logs" title="2.18. Build logs">Build logs</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-dockerfile-build" title="2.19. Dockerfile build triggers fields">Dockerfile build</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-oauth" title="2.20. OAuth configuration">OAuth</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-nested-repositories" title="2.21. Configuring nested repositories">Configuring nested repositories</a>
					</li><li class="listitem">
						<a class="link" href="#other-oci-artifacts-with-quay" title="2.22. Adding other OCI media types to Quay">Adding other OCI media types to Quay</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-mail" title="2.23. Mail configuration">Mail</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-user" title="2.24. User configuration fields">User</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-recaptcha" title="2.25. Recaptcha configuration">Recaptcha</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-aci" title="2.26. ACI configuration">ACI</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-jwt" title="2.27. JTW configuration">JWT</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-app-tokens" title="2.28. App tokens">App tokens</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-misc" title="2.29. Miscellaneous fields">Miscellaneous</a>
					</li><li class="listitem">
						<a class="link" href="#config-fields-legacy" title="2.30. Legacy configuration fields">Legacy options</a>
					</li></ul></div></section><section class="section" id="config-fields-required-general"><div class="titlepage"><div><div><h2 class="title">2.4. General required fields</h2></div></div></div><div class="table" id="idm45162228874656"><p class="title"><strong>Table 2.1. General required fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162231184240" scope="col">Field</th><th align="left" valign="top" id="idm45162231183152" scope="col">Type</th><th align="left" valign="top" id="idm45162231182064" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>AUTHENTICATION_TYPE</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								The authentication engine to use for credential authentication<br/><br/><span class="strong strong"><strong>Values:</strong></span><br/> One of <code class="literal">Database</code>, <code class="literal">LDAP</code>, <code class="literal">JWT</code>, <code class="literal">Keystone</code>, <code class="literal">OIDC</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">Database</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>PREFERRED_URL_SCHEME</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								The URL scheme to use when accessing Red Hat Quay<br/><br/><span class="strong strong"><strong>Values:</strong></span><br/> One of <code class="literal">http</code>, <code class="literal">https</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">http</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>SERVER_HOSTNAME</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								The URL at which Red Hat Quay is accessible, without the scheme<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>DATABASE_SECRET_KEY</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								Key used to encrypt sensitive fields within the database. This value should never be changed once set, otherwise all reliant fields, for example, repository mirror username and password configurations, are invalidated.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>SECRET_KEY</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								Key used to encrypt sensitive fields within the database and at run time. his value should never be changed once set, otherwise all reliant fields, for example, encrypted password credentials, are invalidated.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231184240">
							<p>
								<span class="strong strong"><strong>SETUP_COMPLETE</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231183152">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162231182064">
							<p>
								This is an artefact left over from earlier versions of the software and currently it <span class="strong strong"><strong>must</strong></span> be specified with a value of <code class="literal">true</code>.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-db"><div class="titlepage"><div><div><h2 class="title">2.5. Database configuration</h2></div></div></div><p>
				You configure the connection to the database using the required DB_URI field and optional connection arguments in the DB_CONNECTION_ARGS structure. Some key-value pairs defined under DB_CONNECTION_ARGS are generic while others are database-specific. In particular, SSL configuration depends on the database you are deploying, and examples for PostgreSQL and MySQL are given below.
			</p><section class="section" id="database_uri"><div class="titlepage"><div><div><h3 class="title">2.5.1. Database URI</h3></div></div></div><div class="table" id="idm45162231862256"><p class="title"><strong>Table 2.2. Database URI</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228360400" scope="col">Field</th><th align="left" valign="top" id="idm45162228359312" scope="col">Type</th><th align="left" valign="top" id="idm45162228358224" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228360400">
								<p>
									<span class="strong strong"><strong>DB_URI</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162228359312">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228358224">
								<p>
									The URI for accessing the database, including any credentials
								</p>
								</td></tr></tbody></table></div></div><p>
					<span class="strong strong"><strong>Example:</strong></span>
				</p><pre class="screen">postgresql://quayuser:quaypass@quay-server.example.com:5432/quay</pre></section><section class="section" id="database_connection_arguments"><div class="titlepage"><div><div><h3 class="title">2.5.2. Database connection arguments</h3></div></div></div><div class="table" id="idm45162232065424"><p class="title"><strong>Table 2.3. Database connection arguments</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162232568880" scope="col">Field</th><th align="left" valign="top" id="idm45162232567792" scope="col">Type</th><th align="left" valign="top" id="idm45162232566704" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162232568880">
								<p>
									<span class="strong strong"><strong>DB_CONNECTION_ARGS</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162232567792">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162232566704">
								<p>
									Optional connection arguments for the database, such as timeouts and SSL
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162232568880">
								<p>
									   <span class="strong strong"><strong>.autorollback</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162232567792">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162232566704">
								<p>
									Whether to use thread-local connections<br/>  <br/> Should <span class="strong strong"><strong>ALWAYS</strong></span> be <code class="literal">true</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162232568880">
								<p>
									   <span class="strong strong"><strong>.threadlocals</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162232567792">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162232566704">
								<p>
									Whether to use auto-rollback connections <br/>  <br/> Should <span class="strong strong"><strong>ALWAYS</strong></span> be <code class="literal">true</code>
								</p>
								</td></tr></tbody></table></div></div><section class="section" id="postgresql_ssl_connection_arguments"><div class="titlepage"><div><div><h4 class="title">2.5.2.1. PostgreSQL SSL connection arguments</h4></div></div></div><p>
						A sample PostgreSQL SSL configuration is given below:
					</p><pre class="screen">DB_CONNECTION_ARGS:
  sslmode: verify-ca
  sslrootcert: /path/to/cacert</pre><p>
						The <code class="literal">sslmode</code> option determines whether or with what priority a secure SSL TCP/IP connection will be negotiated with the server. There are six modes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>disable:</strong></span> only try a non-SSL connection
							</li><li class="listitem">
								<span class="strong strong"><strong>allow:</strong></span> first try a non-SSL connection; if that fails, try an SSL connection
							</li><li class="listitem">
								<span class="strong strong"><strong>prefer:</strong></span> (default) first try an SSL connection; if that fails, try a non-SSL connection
							</li><li class="listitem">
								<span class="strong strong"><strong>require:</strong></span> only try an SSL connection. If a root CA file is present, verify the certificate in the same way as if verify-ca was specified
							</li><li class="listitem">
								<span class="strong strong"><strong>verify-ca:</strong></span> only try an SSL connection, and verify that the server certificate is issued by a trusted certificate authority (CA)
							</li><li class="listitem">
								<span class="strong strong"><strong>verify-full:</strong></span> only try an SSL connection, verify that the server certificate is issued by a trusted CA and that the requested server host name matches that in the certificate
							</li></ul></div><p>
						More information on the valid arguments for PostgreSQL is available at <a class="link" href="https://www.postgresql.org/docs/current/libpq-connect.html">https://www.postgresql.org/docs/current/libpq-connect.html</a>.
					</p></section><section class="section" id="mysql_ssl_connection_arguments"><div class="titlepage"><div><div><h4 class="title">2.5.2.2. MySQL SSL connection arguments</h4></div></div></div><p>
						A sample MySQL SSL configuration follows:
					</p><pre class="screen">DB_CONNECTION_ARGS:
  ssl:
    ca: /path/to/cacert</pre><p>
						Information on the valid connection arguments for MySQL is available at <a class="link" href="https://dev.mysql.com/doc/refman/8.0/en/connecting-using-uri-or-key-value-pairs.html">https://dev.mysql.com/doc/refman/8.0/en/connecting-using-uri-or-key-value-pairs.html</a>.
					</p></section></section></section><section class="section" id="config-fields-storage"><div class="titlepage"><div><div><h2 class="title">2.6. Image storage</h2></div></div></div><section class="section" id="config-fields-storage-features"><div class="titlepage"><div><div><h3 class="title">2.6.1. Image storage features</h3></div></div></div><div class="table" id="idm45162231816448"><p class="title"><strong>Table 2.4. Storage config features</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162231316320" scope="col">Field</th><th align="left" valign="top" id="idm45162231315232" scope="col">Type</th><th align="left" valign="top" id="idm45162231314144" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162231316320">
								<p>
									<span class="strong strong"><strong>FEATURE_REPO_MIRROR</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162231315232">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162231314144">
								<p>
									If set to true, enables repository mirroring <br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231316320">
								<p>
									<span class="strong strong"><strong>FEATURE_PROXY_STORAGE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162231315232">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162231314144">
								<p>
									Whether to proxy all direct download URLs in storage via the registry nginx<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231316320">
								<p>
									<span class="strong strong"><strong>FEATURE_STORAGE_REPLICATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162231315232">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162231314144">
								<p>
									Whether to automatically replicate between storage engines<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-storage-fields"><div class="titlepage"><div><div><h3 class="title">2.6.2. Image storage configuration fields</h3></div></div></div><p>
					You specify a list of all storage engines using the DISTRIBUTED_STORAGE_CONFIG field, and choose you preferred storage engine(s) using the DISTRIBUTED_STORAGE_PREFERENCE field.
				</p><p>
					The DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS field is used to control which locations will have their images replicated by default.
				</p><div class="table" id="idm45162231194208"><p class="title"><strong>Table 2.5. Storage config fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162231409824" scope="col">Field</th><th align="left" valign="top" id="idm45162231408736" scope="col">Type</th><th align="left" valign="top" id="idm45162231407648" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162231409824">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_CONFIG</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231408736">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162231407648">
								<p>
									Configuration for storage engine(s) to use in Red Hat Quay. Each key represents an unique identifier for a storage engine. The value consists of a tuple of (key, value) forming an object describing the storage engine parameters.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">[]</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231409824">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231408736">
								<p>
									Array of string
								</p>
								</td><td align="left" valign="top" headers="idm45162231407648">
								<p>
									The list of storage engine(s) (by ID in DISTRIBUTED_STORAGE_CONFIG) whose images should be fully replicated, by default, to all other storage engines.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231409824">
								<p>
									<span class="strong strong"><strong>DISTRIBUTED_STORAGE_PREFERENCE</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231408736">
								<p>
									Array of string
								</p>
								</td><td align="left" valign="top" headers="idm45162231407648">
								<p>
									The preferred storage engine(s) (by ID in DISTRIBUTED_STORAGE_CONFIG) to use. A preferred engine means it is first checked for pulling and images are pushed to it.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231409824">
								<p>
									<span class="strong strong"><strong>MAXIMUM_LAYER_SIZE</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162231408736">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162231407648">
								<p>
									Maximum allowed size of an image layer<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^[0-9]+(G|M)$</code><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">100G</code><br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">20G</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-storage-local"><div class="titlepage"><div><div><h3 class="title">2.6.3. Local storage</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG
  default:
    - LocalStorage
    - storage_path: /datastorage/registry`
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre></section><section class="section" id="config-fields-storage-noobaa"><div class="titlepage"><div><div><h3 class="title">2.6.4. OCS/NooBaa</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG
  rhocsStorage:
    - RHOCSStorage
    - access_key: access_key_here
      secret_key: secret_key_here
      bucket_name: quay-datastore-9b2108a3-29f5-43f2-a9d5-2872174f9a56
      hostname: s3.openshift-storage.svc.cluster.local
      is_secure: 'true'
      port: '443'
      storage_path: /datastorage/registry</pre></section><section class="section" id="config-fields-storage-rados"><div class="titlepage"><div><div><h3 class="title">2.6.5. Ceph / RadosGW Storage / Hitachi HCP</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG
  radosGWStorage:
    - RadosGWStorage
    - access_key: access_key_here
      secret_key: secret_key_here
      bucket_name: bucket_name_here
      hostname: hostname_here
      is_secure: 'true'
      port: '443'
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - default</pre></section><section class="section" id="config-fields-storage-aws"><div class="titlepage"><div><div><h3 class="title">2.6.6. AWS S3 storage</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
  s3Storage:
    - S3Storage
    - host: s3.us-east-2.amazonaws.com
      s3_access_key: ABCDEFGHIJKLMN
      s3_secret_key: OL3ABCDEFGHIJKLMN
      s3_bucket: quay_bucket
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - s3Storage</pre></section><section class="section" id="config-fields-storage-gcp"><div class="titlepage"><div><div><h3 class="title">2.6.7. Google cloud storage</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG:
    googleCloudStorage:
        - GoogleCloudStorage
        - access_key: GOOGQIMFB3ABCDEFGHIJKLMN
          bucket_name: quay-bucket
          secret_key: FhDAYe2HeuAKfvZCAGyOioNaaRABCDEFGHIJKLMN
          storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - googleCloudStorage</pre></section><section class="section" id="config-fields-storage-azure"><div class="titlepage"><div><div><h3 class="title">2.6.8. Azure storage</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG
  azureStorage:
    - AzureStorage
      azure_container: azure_container_here
      storage_path: /datastorage/registry
    - azure_account_name: azure_account_name_here
      azure_account_key: azure_account_key_here
      sas_token: some/path/
      endpoint_url: https://[account-name].blob.core.usgovcloudapi.net <span id="CO1-1"/><span class="callout">1</span>
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - azureStorage</pre><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
							The <code class="literal">endpoint_url</code> parameter for Azure storage is optional. If left blank, the <code class="literal">endpoint_url</code> will connect to the normal Azure region.
						</div></dd></dl></div></section><section class="section" id="config-fields-storage-swift"><div class="titlepage"><div><div><h3 class="title">2.6.9. Swift storage</h3></div></div></div><pre class="programlisting language-yaml">DISTRIBUTED_STORAGE_CONFIG
  swiftStorage:
    - SwiftStorage
    - swift_user: swift_user_here
      swift_password: swift_password_here
      swift_container: swift_container_here
      auth_url: https://example.org/swift/v1/quay
      auth_version: 1
      ca_cert_path: /conf/stack/swift.cert"
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
    - swiftStorage</pre></section></section><section class="section" id="config-fields-redis"><div class="titlepage"><div><div><h2 class="title">2.7. Redis configuration fields</h2></div></div></div><section class="section" id="build_logs"><div class="titlepage"><div><div><h3 class="title">2.7.1. Build logs</h3></div></div></div><div class="table" id="idm45162231108128"><p class="title"><strong>Table 2.6. Build logs configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162231630864" scope="col">Field</th><th align="left" valign="top" id="idm45162231629776" scope="col">Type</th><th align="left" valign="top" id="idm45162231628688" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162231630864">
								<p>
									<span class="strong strong"><strong>BUILDLOGS_REDIS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231629776">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162231628688">
								<p>
									Redis connection details for build logs caching
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231630864">
								<p>
									   <span class="strong strong"><strong>.host</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231629776">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162231628688">
								<p>
									The hostname at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231630864">
								<p>
									   <span class="strong strong"><strong>.port</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162231629776">
								<p>
									Number
								</p>
								</td><td align="left" valign="top" headers="idm45162231628688">
								<p>
									The port at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">6379</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162231630864">
								<p>
									   <span class="strong strong"><strong>.password</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162231629776">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162231628688">
								<p>
									The port at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">strongpassword</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="user_events"><div class="titlepage"><div><div><h3 class="title">2.7.2. User events</h3></div></div></div><div class="table" id="idm45162223717776"><p class="title"><strong>Table 2.7. User events config</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162223816912" scope="col">Field</th><th align="left" valign="top" id="idm45162223815824" scope="col">Type</th><th align="left" valign="top" id="idm45162223814736" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162223816912">
								<p>
									<span class="strong strong"><strong>USER_EVENTS_REDIS</strong></span><br/> (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162223815824">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162223814736">
								<p>
									Redis connection details for user event handling
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162223816912">
								<p>
									   <span class="strong strong"><strong>.host</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162223815824">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162223814736">
								<p>
									The hostname at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162223816912">
								<p>
									   <span class="strong strong"><strong>.port</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162223815824">
								<p>
									Number
								</p>
								</td><td align="left" valign="top" headers="idm45162223814736">
								<p>
									The port at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">6379</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162223816912">
								<p>
									   <span class="strong strong"><strong>.password</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162223815824">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162223814736">
								<p>
									The port at which Redis is accessible<br/>  <br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">strongpassword</code>
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="example_redis_configuration"><div class="titlepage"><div><div><h3 class="title">2.7.3. Example redis configuration</h3></div></div></div><pre class="screen">BUILDLOGS_REDIS:
    host: quay-server.example.com
    password: strongpassword
    port: 6379

USER_EVENTS_REDIS:
    host: quay-server.example.com
    password: strongpassword
    port: 6379</pre></section></section><section class="section" id="config-fields-tag-expiration"><div class="titlepage"><div><div><h2 class="title">2.8. Tag expiration options</h2></div></div></div><div class="table" id="idm45162224257488"><p class="title"><strong>Table 2.8. Tag expiration configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162234698848" scope="col">Field</th><th align="left" valign="top" id="idm45162234697760" scope="col">Type</th><th align="left" valign="top" id="idm45162234696672" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								<span class="strong strong"><strong>FEATURE_GARBAGE_COLLECTION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								Whether garbage collection of repositories is enabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								<span class="strong strong"><strong>TAG_EXPIRATION_OPTIONS</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								Array of string
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								The options that users can select for expiration of tags in their namespace (if enabled)<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								<span class="strong strong"><strong>DEFAULT_TAG_EXPIRATION</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								The default, configurable tag expiration time for time machine.<br/><br/><span class="strong strong"><strong>Pattern:</strong></span> <br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2w</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162234698848">
							<p>
								<span class="strong strong"><strong>FEATURE_CHANGE_TAG_EXPIRATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162234697760">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162234696672">
							<p>
								Whether users and organizations are allowed to change the tag expiration for tags in their namespace<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr></tbody></table></div></div><p>
				Example:
			</p><pre class="screen">DEFAULT_TAG_EXPIRATION: 2w
TAG_EXPIRATION_OPTIONS:
    - 0s
    - 1d
    - 1w
    - 2w
    - 4w</pre></section><section class="section" id="config-preconfigure-automation"><div class="titlepage"><div><div><h2 class="title">2.9. Pre-configuring Quay for automation</h2></div></div></div><p>
				Quay has a number of configuration options that support automation. These options can be set before deployment, to minimize the need to interact with the user interface.
			</p><section class="section" id="allowing_the_api_to_create_the_first_user"><div class="titlepage"><div><div><h3 class="title">2.9.1. Allowing the API to create the first user</h3></div></div></div><p>
					Set the config option <code class="literal">FEATURE_USER_INITIALIZE</code> to <code class="literal">true</code>, so that you can use the API <code class="literal">/api/v1/user/initialize</code> to create the first user. This API endpoint does not require authentication, unlike all other registry API calls which require an OAuth token which is generated by an OAuth application in an existing organization.
				</p><p>
					Once you have deployed Quay, you can use the API to create a user, for example, <code class="literal">quayadmin</code>, provided no other users have already been created. For more information, see the section on <a class="link" href="#first-user-api" title="2.9.7. Using the API to create the first user">Creating the first user using the API</a>.
				</p></section><section class="section" id="enabling_general_api_access"><div class="titlepage"><div><div><h3 class="title">2.9.2. Enabling general API access</h3></div></div></div><p>
					Set the config option <code class="literal">BROWSER_API_CALLS_XHR_ONLY</code> to <code class="literal">false</code>, to allow general access to the Quay registry API.
				</p></section><section class="section" id="adding_a_super_user"><div class="titlepage"><div><div><h3 class="title">2.9.3. Adding a super user</h3></div></div></div><p>
					While you cannot create a user until after deployment, it is convenient to ensure that first user is an administrator with full permissions. It is easier to configure this in advance, using the <code class="literal">SUPER_USER</code> configuration object.
				</p></section><section class="section" id="restricting_user_creation"><div class="titlepage"><div><div><h3 class="title">2.9.4. Restricting user creation</h3></div></div></div><p>
					Once you have configured a super user, you can restrict the ability to create new users to the super user group. Set the <code class="literal">FEATURE_USER_CREATION</code> to <code class="literal">false</code> to restrict user creation.
				</p></section><section class="section" id="suggested_configuration_for_automation"><div class="titlepage"><div><div><h3 class="title">2.9.5. Suggested configuration for automation</h3></div></div></div><p>
					Create a <code class="literal">config.yaml</code> configuration file that includes the appropriate settings:
				</p><div class="formalpara"><p class="title"><strong>config.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">...
FEATURE_USER_INITIALIZE: true
BROWSER_API_CALLS_XHR_ONLY: false
SUPER_USERS:
- quayadmin
FEATURE_USER_CREATION: false
...</pre>
					</p></div></section><section class="section" id="deploying_the_operator_using_the_initial_configuration"><div class="titlepage"><div><div><h3 class="title">2.9.6. Deploying the Operator using the initial configuration</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a Secret using the configuration file
						</p><pre class="screen">$ oc create secret generic --from-file config.yaml=./config.yaml init-config-bundle-secret</pre></li><li class="listitem"><p class="simpara">
							Create a QuayRegistry YAML file <code class="literal">quayregistry.yaml</code>, identifying the unmanaged components and also referencing the created Secret, for example:
						</p><div class="formalpara"><p class="title"><strong>quayregistry.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: init-config-bundle-secret</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Deploy the registry:
						</p><pre class="screen">$ oc create -f quayregistry.yaml</pre></li><li class="listitem">
							Create the first user, <code class="literal">quayadmin</code>, using the API
						</li></ol></div></section><section class="section" id="first-user-api"><div class="titlepage"><div><div><h3 class="title">2.9.7. Using the API to create the first user</h3></div></div></div><p>
					When using the API to create the first user, the following conditions must be met:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The config option <code class="literal">FEATURE_USER_INITIALIZE</code> must be set to <code class="literal">true</code>
						</li><li class="listitem">
							No users can already exist in the database
						</li></ul></div><p>
					For more information on pre-configuring the deployment, see the section <a class="link" href="#config-preconfigure-automation" title="2.9. Pre-configuring Quay for automation">Pre-configuring Quay for automation</a>
				</p><section class="section" id="invoking_the_api"><div class="titlepage"><div><div><h4 class="title">2.9.7.1. Invoking the API</h4></div></div></div><p>
						Using the <code class="literal">status.registryEndpoint</code> URL, invoke the <code class="literal">/api/v1/user/initialize</code> API, passing in the username, password and email address. You can also request an OAuth token by specifying <code class="literal">"access_token": true</code>.
					</p><pre class="programlisting language-bash">$  curl -X POST -k  https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/user/initialize --header 'Content-Type: application/json' --data '{ "username": "quayadmin", "password":"quaypass123", "email": "quayadmin@example.com", "access_token": true}'</pre><pre class="programlisting language-yaml">{"access_token":"6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED", "email":"quayadmin@example.com","encrypted_password":"1nZMLH57RIE5UGdL/yYpDOHLqiNCgimb6W9kfF8MjZ1xrfDpRyRs9NUnUuNuAitW","username":"quayadmin"}</pre><p>
						If successful, the method returns an object with the username, email and encrypted password. If a user already exists in the database, an error is returned:
					</p><pre class="programlisting language-bash">$  curl -X POST -k  https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/user/initialize --header 'Content-Type: application/json' --data '{ "username": "quayuser2", "password":"quaypass123", "email": "quayuser2@example.com"}'</pre><pre class="programlisting language-yaml">{"message":"Cannot initialize user in a non-empty database"}</pre><p>
						The password must be at least 8 characters and contain no whitespace:
					</p><pre class="programlisting language-bash"> $  curl -X POST -k  https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/user/initialize --header 'Content-Type: application/json' --data '{ "username": "quayadmin", "password":"pass123", "email": "quayadmin@example.com"}'</pre><pre class="programlisting language-yaml">{"message":"Failed to initialize user: Invalid password, password must be at least 8 characters and contain no whitespace."}</pre></section><section class="section" id="using_the_oauth_token"><div class="titlepage"><div><div><h4 class="title">2.9.7.2. Using the OAuth token</h4></div></div></div><p>
						You can now invoke the rest of the Quay API specifying the returned OAuth code. For example, to get a list of the current users:
					</p><pre class="programlisting language-bash">$ curl -X GET -k -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/superuser/users/</pre><pre class="programlisting language-yaml">{
    "users": [
        {
            "kind": "user",
            "name": "quayadmin",
            "username": "quayadmin",
            "email": "quayadmin@example.com",
            "verified": true,
            "avatar": {
                "name": "quayadmin",
                "hash": "3e82e9cbf62d25dec0ed1b4c66ca7c5d47ab9f1f271958298dea856fb26adc4c",
                "color": "#e7ba52",
                "kind": "user"
            },
            "super_user": true,
            "enabled": true
        }
    ]
}</pre><p>
						In this instance, the details for the <code class="literal">quayadmin</code> user are returned as it is the only user that has been created so far.
					</p><section class="section" id="create_organization"><div class="titlepage"><div><div><h5 class="title">2.9.7.2.1. Create organization</h5></div></div></div><p>
							To create an organization, use a POST call to <code class="literal">api/v1/organization/</code> endpoint:
						</p><pre class="programlisting language-bash">$ curl -X POST -k --header 'Content-Type: application/json' -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://example-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/organization/ --data '{"name": "testorg", "email": "testorg@example.com"}'</pre><pre class="programlisting language-yaml">"Created"</pre></section><section class="section" id="get_organization_details"><div class="titlepage"><div><div><h5 class="title">2.9.7.2.2. Get organization details</h5></div></div></div><p>
							To retrieve the details of the organization you created:
						</p><pre class="programlisting language-bash">$ curl -X GET -k --header 'Content-Type: application/json' -H "Authorization: Bearer 6B4QTRSTSD1HMIG915VPX7BMEZBVB9GPNY2FC2ED" https://min-registry-quay-quay-enterprise.apps.docs.quayteam.org/api/v1/organization/testorg</pre><pre class="programlisting language-yaml">{
    "name": "testorg",
    "email": "testorg@example.com",
    "avatar": {
        "name": "testorg",
        "hash": "5f113632ad532fc78215c9258a4fb60606d1fa386c91b141116a1317bf9c53c8",
        "color": "#a55194",
        "kind": "user"
    },
    "is_admin": true,
    "is_member": true,
    "teams": {
        "owners": {
            "name": "owners",
            "description": "",
            "role": "admin",
            "avatar": {
                "name": "owners",
                "hash": "6f0e3a8c0eb46e8834b43b03374ece43a030621d92a7437beb48f871e90f8d90",
                "color": "#c7c7c7",
                "kind": "team"
            },
            "can_view": true,
            "repo_count": 0,
            "member_count": 1,
            "is_synced": false
        }
    },
    "ordered_teams": [
        "owners"
    ],
    "invoice_email": false,
    "invoice_email_address": null,
    "tag_expiration_s": 1209600,
    "is_free_account": true
}</pre></section></section></section></section><section class="section" id="config-fields-basic"><div class="titlepage"><div><div><h2 class="title">2.10. Basic configuration</h2></div></div></div><div class="table" id="idm45162231532768"><p class="title"><strong>Table 2.9. Basic configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162231527008" scope="col">Field</th><th align="left" valign="top" id="idm45162231603152" scope="col">Type</th><th align="left" valign="top" id="idm45162231602064" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								<span class="strong strong"><strong>REGISTRY_TITLE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								If specified, the long-form title for the registry<br/><br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">Quay Enterprise</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								<span class="strong strong"><strong>REGISTRY_TITLE_SHORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								If specified, the short-form title for the registry.<br/><br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">Quay Enterprise</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								<span class="strong strong"><strong>BRANDING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								Object
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Custom branding for logos and URLs in the Red Hat Quay UI.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>.logo</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Main logo image URL<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">/static/img/quay-horizontal-color.svg</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>.footer_img</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Logo for UI footer<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">/static/img/RedHat.svg</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>.footer_url</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Link for footer image<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="https://redhat.com">https://redhat.com</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								<span class="strong strong"><strong>CONTACT_INFO</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								If specified, contact information to display on the contact page. If only a single piece of contact information is specified, the contact footer will link directly.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>[0]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Adds a link to send an e-mail<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^mailto:(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">mailto:support@quay.io</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>[1]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Adds a link to visit an IRC chat room<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^irc://(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="irc://chat.freenode.net:6665/quay">irc://chat.freenode.net:6665/quay</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>[2]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Adds a link to call a phone number+ <br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^tel:(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">tel:+1-888-930-3475</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162231527008">
							<p>
								   <span class="strong strong"><strong>[3]</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162231603152">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162231602064">
							<p>
								Adds a link to a defined URL<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="https://twitter.com/quayio">https://twitter.com/quayio</a></code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-ssl"><div class="titlepage"><div><div><h2 class="title">2.11. SSL configuration fields</h2></div></div></div><div class="table" id="idm45162228614320"><p class="title"><strong>Table 2.10. SSL configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225354688" scope="col">Field</th><th align="left" valign="top" id="idm45162225353600" scope="col">Type</th><th align="left" valign="top" id="idm45162225352512" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225354688">
							<p>
								<span class="strong strong"><strong>PREFERRED_URL_SCHEME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225353600">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225352512">
							<p>
								One of <code class="literal">http</code> or <code class="literal">https</code>. Note that users only set their <code class="literal">PREFERRED_URL_SCHEME</code> to <code class="literal">http</code> when there is no TLS encryption in the communication path from the client to Quay.
							</p>
							<p>
								+ Users must set their <code class="literal">PREFERRED_URL_SCHEME`to `https</code> when using a TLS-terminating load balancer, a reverse proxy (for example, Nginx), or when using Quay with custom SSL certificates directly. In most cases, the <code class="literal">PREFERRED_URL_SCHEME</code> should be <code class="literal">https</code>. <br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">http</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225354688">
							<p>
								<span class="strong strong"><strong>SERVER_HOSTNAME</strong></span> <br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162225353600">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225352512">
							<p>
								The URL at which Red Hat Quay is accessible, without the scheme<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">quay-server.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225354688">
							<p>
								<span class="strong strong"><strong>SSL_CIPHERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225353600">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162225352512">
							<p>
								If specified, the nginx-defined list of SSL ciphers to enabled and disabled<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/> [<code class="literal">CAMELLIA</code>, <code class="literal">!3DES</code>]
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225354688">
							<p>
								<span class="strong strong"><strong>SSL_PROTOCOLS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225353600">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162225352512">
							<p>
								If specified, nginx is configured to enabled a list of SSL protocols defined in the list. Removing an SSL protocol from the list disables the protocol during Red Hat Quay startup.<br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">['TLSv1','TLSv1.1','TLSv1.2']</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225354688">
							<p>
								<span class="strong strong"><strong>SESSION_COOKIE_SECURE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225353600">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162225352512">
							<p>
								Whether the <code class="literal">secure</code> property should be set on session cookies<br/><br/><span class="strong strong"><strong>Default:</strong></span><br/> False<br/><br/><span class="strong strong"><strong>Recommendation:</strong></span><br/> Set to True for all installations using SSL
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="configuring_ssl"><div class="titlepage"><div><div><h3 class="title">2.11.1. Configuring SSL</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Copy the certificate file and primary key file to your configuration directory, ensuring they are named <code class="literal">ssl.cert</code> and <code class="literal">ssl.key</code> respectively:
						</p><pre class="screen">$ cp ~/ssl.cert $QUAY/config
$ cp ~/ssl.key $QUAY/config
$ cd $QUAY/config</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">config.yaml</code> file and specify that you want Quay to handle TLS:
						</p><div class="formalpara"><p class="title"><strong>config.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">...
SERVER_HOSTNAME: quay-server.example.com
...
PREFERRED_URL_SCHEME: https
...</pre>
							</p></div></li><li class="listitem">
							Stop the <code class="literal">Quay</code> container and restart the registry
						</li></ol></div></section></section><section class="section" id="config-custom-ssl-certs-manual"><div class="titlepage"><div><div><h2 class="title">2.12. Adding TLS Certificates to the Red Hat Quay Container</h2></div></div></div><p>
				To add custom TLS certificates to Red Hat Quay, create a new directory named <code class="literal">extra_ca_certs/</code> beneath the Red Hat Quay config directory. Copy any required site-specific TLS certificates to this new directory.
			</p><section class="section" id="add-certificates-to-quay-container"><div class="titlepage"><div><div><h3 class="title">2.12.1. Add TLS certificates to Red Hat Quay</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							View certificate to be added to the container
						</p><pre class="screen">$ cat storage.crt
-----BEGIN CERTIFICATE-----
MIIDTTCCAjWgAwIBAgIJAMVr9ngjJhzbMA0GCSqGSIb3DQEBCwUAMD0xCzAJBgNV
[...]
-----END CERTIFICATE-----</pre></li><li class="listitem"><p class="simpara">
							Create certs directory and copy certificate there
						</p><pre class="screen">$ mkdir -p quay/config/extra_ca_certs
$ cp storage.crt quay/config/extra_ca_certs/
$ tree quay/config/
├── config.yaml
├── extra_ca_certs
│   ├── storage.crt</pre></li><li class="listitem"><p class="simpara">
							Obtain the <code class="literal">Quay</code> container’s <code class="literal">CONTAINER ID</code> with <code class="literal">podman ps</code>:
						</p><pre class="screen">$ sudo podman ps
CONTAINER ID        IMAGE                                COMMAND                  CREATED             STATUS              PORTS
5a3e82c4a75f        &lt;registry&gt;/&lt;repo&gt;/quay:v3.7.0 "/sbin/my_init"          24 hours ago        Up 18 hours         0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, 443/tcp   grave_keller</pre></li><li class="listitem"><p class="simpara">
							Restart the container with that ID:
						</p><pre class="screen">$ sudo podman restart 5a3e82c4a75f</pre></li><li class="listitem"><p class="simpara">
							Examine the certificate copied into the container namespace:
						</p><pre class="screen">$ sudo podman exec -it 5a3e82c4a75f cat /etc/ssl/certs/storage.pem
-----BEGIN CERTIFICATE-----
MIIDTTCCAjWgAwIBAgIJAMVr9ngjJhzbMA0GCSqGSIb3DQEBCwUAMD0xCzAJBgNV</pre></li></ol></div></section></section><section class="section" id="config-fields-ldap"><div class="titlepage"><div><div><h2 class="title">2.13. LDAP configuration fields</h2></div></div></div><div class="table" id="idm45162226735952"><p class="title"><strong>Table 2.11. LDAP configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162227383392" scope="col">Field</th><th align="left" valign="top" id="idm45162227382304" scope="col">Type</th><th align="left" valign="top" id="idm45162227381216" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>AUTHENTICATION_TYPE</strong></span><br/> (Required)
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								Must be set to <code class="literal">LDAP</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>FEATURE_TEAM_SYNCING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								Whether to allow for team membership to be synced from a backing group in the authentication engine (LDAP or Keystone)<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>FEATURE_NONSUPERUSER_TEAM_SYNCING_SETUP</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								If enabled, non-superusers can setup syncing on teams using LDAP<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_ADMIN_DN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The admin DN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_ADMIN_PASSWD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The admin password for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_ALLOW_INSECURE_FALLBACK</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								Whether or not to allow SSL insecure fallback for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_BASE_DN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The base DN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_EMAIL_ATTR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The email attribute for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_UID_ATTR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The uid attribute for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_URI</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The LDAP URI.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_USER_FILTER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The user filter for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>LDAP_USER_RDN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								The user RDN for LDAP authentication.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227383392">
							<p>
								<span class="strong strong"><strong>TEAM_RESYNC_STALE_TIME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227382304">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162227381216">
							<p>
								If team syncing is enabled for a team, how often to check its membership and resync if necessary<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal">2h</code><br/><span class="strong strong"><strong>Default:</strong></span><br/><code class="literal">30m</code>
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="ldap_configuration_example"><div class="titlepage"><div><div><h3 class="title">2.13.1. LDAP configuration example</h3></div></div></div><div class="formalpara"><p class="title"><strong>$QUAY/config/config.yaml</strong></p><p>
						
<pre class="programlisting language-yaml">AUTHENTICATION_TYPE: LDAP
...
LDAP_ADMIN_DN: uid=testuser,ou=Users,o=orgid,dc=jumpexamplecloud,dc=com
LDAP_ADMIN_PASSWD: samplepassword
LDAP_ALLOW_INSECURE_FALLBACK: false
LDAP_BASE_DN:
    - o=orgid
    - dc=example
    - dc=com
LDAP_EMAIL_ATTR: mail
LDAP_UID_ATTR: uid
LDAP_URI: ldap://ldap.example.com:389
LDAP_USER_RDN:
    - ou=Users</pre>
					</p></div></section></section><section class="section" id="config-fields-mirroring"><div class="titlepage"><div><div><h2 class="title">2.14. Mirroring configuration fields</h2></div></div></div><div class="table" id="idm45162226438080"><p class="title"><strong>Table 2.12. Mirroring configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226488048" scope="col">Field</th><th align="left" valign="top" id="idm45162226486960" scope="col">Type</th><th align="left" valign="top" id="idm45162226485872" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226488048">
							<p>
								<span class="strong strong"><strong>FEATURE_REPO_MIRROR</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226486960">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226485872">
							<p>
								Enable or disable repository mirroring<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226488048">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162226486960">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162226485872">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226488048">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226486960">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162226485872">
							<p>
								The number of seconds between checking for repository mirror candidates<br/><br/><span class="strong strong"><strong>Default:</strong></span> 30
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226488048">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_SERVER_HOSTNAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226486960">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226485872">
							<p>
								Replaces the <code class="literal">SERVER_HOSTNAME</code> as the destination for mirroring. <br/><br/><span class="strong strong"><strong>Default:</strong></span> None<br/><br/><span class="strong strong"><strong>Example</strong></span>:<br/><code class="literal">openshift-quay-service</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226488048">
							<p>
								<span class="strong strong"><strong>REPO_MIRROR_TLS_VERIFY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226486960">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226485872">
							<p>
								Require HTTPS and verify certificates of Quay registry during mirror.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-scanner"><div class="titlepage"><div><div><h2 class="title">2.15. Security scanner configuration fields</h2></div></div></div><div class="table" id="idm45162226800736"><p class="title"><strong>Table 2.13. Security scanner configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226794960" scope="col">Field</th><th align="left" valign="top" id="idm45162226793872" scope="col">Type</th><th align="left" valign="top" id="idm45162226792784" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>FEATURE_SECURITY_SCANNER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								Enable or disable the security scanner<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>FEATURE_SECURITY_NOTIFICATIONS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								If the security scanner is enabled, turn on or turn off security notifications<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_REINDEX_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								This parameter is used to determine the minimum time, in seconds, to wait before re-indexing a manifest that has either previously failed or has changed states since the last indexing. The data is calculated from the <code class="literal">last_indexed datetime</code> in the <span class="strong strong"><strong>manifestsecuritystatus</strong></span> table. This parameter is used to avoid trying to re-index every failed manifest on every indexing run. The default time to re-index is 300 seconds.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								The endpoint for the V4 security scanner<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_PSK</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								The generated pre-shared key (PSK) for Clair
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_INDEXING_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								The number of seconds between indexing intervals in the security scanner<br/><br/><span class="strong strong"><strong>Default:</strong></span> 30
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								The endpoint for the V2 security scanner<br/><br/><span class="strong strong"><strong>Pattern:</strong></span><br/><code class="literal">^http(s)?://(.)+$</code><br/><br/><span class="strong strong"><strong>Example:</strong></span><br/><code class="literal"><a class="link" href="http://192.168.99.100:6060">http://192.168.99.100:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226794960">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_INDEXING_INTERVAL</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226793872">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162226792784">
							<p>
								This parameter is used to determine the number of seconds between indexing intervals in the security scanner. When indexing is triggered, Red Hat Quay will query its database for manifests that must be indexed by Clair. These include manifests that have not yet been indexed and manifests that previously failed indexing.
							</p>
							</td></tr></tbody></table></div></div><p>
				The following is a special case for re-indexing:
			</p><p>
				When Clair v4 indexes a manifest, the result should be deterministic. For example, the same manifest should produce the same index report. This is true until the scanners are changed, as using different scanners will produce different information relating to a specific manifest to be returned in the report. Because of this, Clair v4 exposes a state representation of the indexing engine (<code class="literal">/indexer/api/v1/index_state</code>) to determine whether the scanner configuration has been changed.
			</p><p>
				Red Hat Quay leverages this index state by saving it to the index report when parsing to Quay’s database. If this state has changed since the manifest was previously scanned, Quay will attempt to re-index that manifest during the periodic indexing process.
			</p><p>
				By default this parameter is set to 30 seconds. Users might decrease the time if they want the indexing process to run more frequently, for example, if they did not want to wait 30 seconds to see security scan results in the UI after pushing a new tag. Users can also change the parameter if they want more control over the request pattern to Clair and the pattern of database operations being performed on the Quay database.
			</p></section><section class="section" id="config-fields-helm-oci"><div class="titlepage"><div><div><h2 class="title">2.16. OCI and Helm configuration</h2></div></div></div><p>
				Support for Helm is now supported under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. If you need to explicitly enable the feature, for example, if it has previously been disabled or if you have upgraded from a version where it is not enabled by default, you need to add two properties in the Quay configuration to enable the use of OCI artifacts:
			</p><pre class="programlisting language-yaml">FEATURE_GENERAL_OCI_SUPPORT: true
FEATURE_HELM_OCI_SUPPORT: true</pre><div class="table" id="idm45162226720672"><p class="title"><strong>Table 2.14. OCI and Helm configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226714896" scope="col">Field</th><th align="left" valign="top" id="idm45162226713808" scope="col">Type</th><th align="left" valign="top" id="idm45162226712720" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226714896">
							<p>
								<span class="strong strong"><strong>FEATURE_GENERAL_OCI_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226713808">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226712720">
							<p>
								Enable support for OCI artifacts<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226714896">
							<p>
								<span class="strong strong"><strong>FEATURE_HELM_OCI_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226713808">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226712720">
							<p>
								Enable support for Helm artifacts<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr></tbody></table></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					As of Red Hat Quay 3.7, <code class="literal">FEATURE_HELM_OCI_SUPPORT</code> has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.7, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their config.yaml files to enable support.
				</p></div></div></section><section class="section" id="config-fields-actionlog"><div class="titlepage"><div><div><h2 class="title">2.17. Action log configuration fields</h2></div></div></div><section class="section" id="action_log_storage_configuration"><div class="titlepage"><div><div><h3 class="title">2.17.1. Action log storage configuration</h3></div></div></div><div class="table" id="idm45162226168176"><p class="title"><strong>Table 2.15. Action log storage configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226162400" scope="col">Field</th><th align="left" valign="top" id="idm45162226161312" scope="col">Type</th><th align="left" valign="top" id="idm45162226160224" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226162400">
								<p>
									<span class="strong strong"><strong>FEATURE_LOG_EXPORT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226161312">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162226160224">
								<p>
									Whether to allow exporting of action logs<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">True</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226162400">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162226161312">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162226160224">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226162400">
								<p>
									<span class="strong strong"><strong>LOGS_MODEL</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226161312">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226160224">
								<p>
									Enable or disable the security scanner<br/><br/><span class="strong strong"><strong>Values:</strong></span> One of <code class="literal">database</code>, <code class="literal">transition_reads_both_writes_es</code>, <code class="literal">elasticsearch</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">database</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226162400">
								<p>
									<span class="strong strong"><strong>LOGS_MODEL_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226161312">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162226160224">
								<p>
									Logs model config for action logs
								</p>
								</td></tr></tbody></table></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>LOGS_MODEL_CONFIG</strong></span> [object]: Logs model config for action logs
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>elasticsearch_config</strong></span> [object]: Elasticsearch cluster configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>access_key</strong></span> [string]: Elasticsearch user (or IAM key for AWS ES)
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_string</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>host</strong></span> [string]: Elasticsearch cluster endpoint
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">host.elasticsearch.example</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>index_prefix</strong></span> [string]: Elasticsearch’s index prefix
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry_</code>
												</li></ul></div></li><li class="listitem">
											<span class="strong strong"><strong>index_settings</strong></span> [object]: Elasticsearch’s index settings
										</li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>use_ssl</strong></span> [boolean]: Use ssl for Elasticsearch. Defaults to True
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">True</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>secret_key</strong></span> [string]: Elasticsearch password (or IAM secret for AWS ES)
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_secret_string</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_region</strong></span> [string]: Amazon web service region
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">us-east-1</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>port</strong></span> [number]: Elasticsearch cluster endpoint port
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">1234</code>
												</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>kinesis_stream_config</strong></span> [object]: AWS Kinesis Stream configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_secret_key</strong></span> [string]: AWS secret key
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_secret_key</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>stream_name</strong></span> [string]: Kinesis stream to send action logs to
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry-kinesis-stream</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_access_key</strong></span> [string]: AWS access key
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">some_access_key</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>retries</strong></span> [number]: Max number of attempts made on a single request
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>read_timeout</strong></span> [number]: Number of seconds before timeout when reading from a connection
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>max_pool_connections</strong></span> [number]: The maximum number of connections to keep in a connection pool
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">10</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>aws_region</strong></span> [string]: AWS region
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">us-east-1</code>
												</li></ul></div></li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>connect_timeout</strong></span> [number]: Number of seconds before timeout when attempting to make a connection
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">5</code>
												</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>producer</strong></span> [string]: Logs producer if logging to Elasticsearch
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
											<span class="strong strong"><strong>enum</strong></span>: kafka, elasticsearch, kinesis_stream
										</li><li class="listitem">
											<span class="strong strong"><strong>Example</strong></span>: <code class="literal">kafka</code>
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<span class="strong strong"><strong>kafka_config</strong></span> [object]: Kafka cluster configuration
								</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>topic</strong></span> [string]: Kafka topic to publish log entries to
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">logentry</code>
												</li></ul></div></li><li class="listitem">
											<span class="strong strong"><strong>bootstrap_servers</strong></span> [array]: List of Kafka brokers to bootstrap the client from
										</li><li class="listitem"><p class="simpara">
											<span class="strong strong"><strong>max_block_seconds</strong></span> [number]: Max number of seconds to block during a <code class="literal">send()</code>, either because the buffer is full or metadata unavailable
										</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
													<span class="strong strong"><strong>Example</strong></span>: <code class="literal">10</code>
												</li></ul></div></li></ul></div></li></ul></div></li></ul></div></section><section class="section" id="action_log_rotation_and_archiving_configuration"><div class="titlepage"><div><div><h3 class="title">2.17.2. Action log rotation and archiving configuration</h3></div></div></div><div class="table" id="idm45162224675456"><p class="title"><strong>Table 2.16. Action log rotation and archiving configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228573632" scope="col">Field</th><th align="left" valign="top" id="idm45162228572544" scope="col">Type</th><th align="left" valign="top" id="idm45162228571456" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228573632">
								<p>
									<span class="strong strong"><strong>FEATURE_ACTION_LOG_ROTATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228572544">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162228571456">
								<p>
									Enabling log rotation and archival will move all logs older than 30 days to storage<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228573632">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162228572544">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162228571456">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228573632">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ARCHIVE_LOCATION</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228572544">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228571456">
								<p>
									If action log archiving is enabled, the storage engine in which to place the archived data<br/><br/><span class="strong strong"><strong>Example:</strong></span>: <code class="literal">s3_us_east</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228573632">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ARCHIVE_PATH</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228572544">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228571456">
								<p>
									If action log archiving is enabled, the path in storage in which to place the archived data<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">archives/actionlogs</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228573632">
								<p>
									<span class="strong strong"><strong>ACTION_LOG_ROTATION_THRESHOLD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228572544">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228571456">
								<p>
									The time interval after which to rotate logs<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">30d</code>
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-build-logs"><div class="titlepage"><div><div><h2 class="title">2.18. Build logs</h2></div></div></div><div class="table" id="idm45162225132448"><p class="title"><strong>Table 2.17. Build logs</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225126688" scope="col">Field</th><th align="left" valign="top" id="idm45162225125600" scope="col">Type</th><th align="left" valign="top" id="idm45162225124512" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225126688">
							<p>
								<span class="strong strong"><strong>FEATURE_READER_BUILD_LOGS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225125600">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162225124512">
							<p>
								If set to true, build logs may be read by those with read access to the repo, rather than only write access or admin access.<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225126688">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162225125600">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162225124512">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225126688">
							<p>
								<span class="strong strong"><strong>LOG_ARCHIVE_LOCATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225125600">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225124512">
							<p>
								The storage location, defined in DISTRIBUTED_STORAGE_CONFIG, in which to place the archived build logs<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">s3_us_east</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225126688">
							<p>
								<span class="strong strong"><strong>LOG_ARCHIVE_PATH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225125600">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225124512">
							<p>
								The path under the configured storage engine in which to place the archived build logs in JSON form<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">archives/buildlogs</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-dockerfile-build"><div class="titlepage"><div><div><h2 class="title">2.19. Dockerfile build triggers fields</h2></div></div></div><div class="table" id="idm45162226693360"><p class="title"><strong>Table 2.18. Dockerfile build support</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226687584" scope="col">Field</th><th align="left" valign="top" id="idm45162226686496" scope="col">Type</th><th align="left" valign="top" id="idm45162226685408" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226687584">
							<p>
								<span class="strong strong"><strong>FEATURE_BUILD_SUPPORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226686496">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162226685408">
							<p>
								Whether to support Dockerfile build. <br/><br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226687584">
							<p>
								<span class="strong strong"><strong>SUCCESSIVE_TRIGGER_FAILURE_DISABLE_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226686496">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162226685408">
							<p>
								If not None, the number of successive failures that can occur before a build trigger is automatically disabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> 100
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162226687584">
							<p>
								<span class="strong strong"><strong>SUCCESSIVE_TRIGGER_INTERNAL_ERROR_DISABLE_THRESHOLD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162226686496">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162226685408">
							<p>
								If not None, the number of successive internal errors that can occur before a build trigger is automatically disabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> 5
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="github_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.19.1. GitHub build triggers</h3></div></div></div><div class="table" id="idm45162227088688"><p class="title"><strong>Table 2.19. GitHub build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226153392" scope="col">Field</th><th align="left" valign="top" id="idm45162226152304" scope="col">Type</th><th align="left" valign="top" id="idm45162226151216" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									<span class="strong strong"><strong>FEATURE_GITHUB_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									Whether to support GitHub build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									<span class="strong strong"><strong>GITHUB_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									Configuration for using GitHub (Enterprise) for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									   <span class="strong strong"><strong>.GITHUB_ENDPOINT</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									The endpoint for GitHub (Enterprise)<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal"><a class="link" href="https://github.com/">https://github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									   <span class="strong strong"><strong>.API_ENDPOINT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									The endpoint of the GitHub (Enterprise) API to use. Must be overridden for <code class="literal">github.com</code><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="https://api.github.com/">https://api.github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									The registered client ID for this Red Hat Quay instance; this cannot be shared with GITHUB_LOGIN_CONFIG.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226153392">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162226152304">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226151216">
								<p>
									The registered client secret for this Red Hat Quay instance.
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="bitbucket_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.19.2. BitBucket build triggers</h3></div></div></div><div class="table" id="idm45162225190608"><p class="title"><strong>Table 2.20. BitBucket build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225184832" scope="col">Field</th><th align="left" valign="top" id="idm45162225183744" scope="col">Type</th><th align="left" valign="top" id="idm45162225182656" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225184832">
								<p>
									<span class="strong strong"><strong>FEATURE_BITBUCKET_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162225183744">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162225182656">
								<p>
									Whether to support Bitbucket build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162225184832">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162225183744">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162225182656">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162225184832">
								<p>
									<span class="strong strong"><strong>BITBUCKET_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162225183744">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162225182656">
								<p>
									Configuration for using BitBucket for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162225184832">
								<p>
									   <span class="strong strong"><strong>.CONSUMER_KEY</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162225183744">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162225182656">
								<p>
									The registered consumer key (client ID) for this Quay instance
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162225184832">
								<p>
									   <span class="strong strong"><strong>.CONSUMER_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162225183744">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162225182656">
								<p>
									The registered consumer secret (client secret) for this Quay instance
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="gitlab_build_triggers"><div class="titlepage"><div><div><h3 class="title">2.19.3. GitLab build triggers</h3></div></div></div><div class="table" id="idm45162224534832"><p class="title"><strong>Table 2.21. GitLab build triggers</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162224529072" scope="col">Field</th><th align="left" valign="top" id="idm45162224527984" scope="col">Type</th><th align="left" valign="top" id="idm45162224526896" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									<span class="strong strong"><strong>FEATURE_GITLAB_BUILD</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									Whether to support GitLab build triggers<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									 
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									 
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									<span class="strong strong"><strong>GITLAB_TRIGGER_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									Configuration for using Gitlab for build triggers
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									   <span class="strong strong"><strong>.GITLAB_ENDPOINT</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									The endpoint at which Gitlab (Enterprise) is running
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									The registered client ID for this Quay instance
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162224529072">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162224527984">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162224526896">
								<p>
									The registered client secret for this Quay instance
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-oauth"><div class="titlepage"><div><div><h2 class="title">2.20. OAuth configuration</h2></div></div></div><div class="table" id="idm45162223961904"><p class="title"><strong>Table 2.22. OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162223956144" scope="col">Field</th><th align="left" valign="top" id="idm45162223955056" scope="col">Type</th><th align="left" valign="top" id="idm45162223953968" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162223956144">
							<p>
								<span class="strong strong"><strong>DIRECT_OAUTH_CLIENTID_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162223955056">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162223953968">
							<p>
								A list of client IDs for <span class="strong strong"><strong>Quay-managed</strong></span> applications that are allowed to perform direct OAuth approval without user approval.
							</p>
							</td></tr></tbody></table></div></div><section class="section" id="github_oauth"><div class="titlepage"><div><div><h3 class="title">2.20.1. GitHub OAuth</h3></div></div></div><div class="table" id="idm45162228505984"><p class="title"><strong>Table 2.23. GitHub OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228500224" scope="col">Field</th><th align="left" valign="top" id="idm45162228499136" scope="col">Type</th><th align="left" valign="top" id="idm45162228498048" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									<span class="strong strong"><strong>FEATURE_GITHUB_LOGIN</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									Whether GitHub login is supported<br/><br/> **Default: <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									<span class="strong strong"><strong>GITHUB_LOGIN_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									Configuration for using GitHub (Enterprise) as an external login provider.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.ALLOWED_ORGANIZATIONS</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									Array of String
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									The names of the GitHub (Enterprise) organizations whitelisted to work with the ORG_RESTRICT option.
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.API_ENDPOINT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									The endpoint of the GitHub (Enterprise) API to use. Must be overridden for github.com<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal"><a class="link" href="https://api.github.com/">https://api.github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									The registered client ID for this Red Hat Quay instance; cannot be shared with GITHUB_TRIGGER_CONFIG<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">0e8dbe15c4c7630b6780</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									The registered client secret for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">e4a58ddd3d7408b7aec109e85564a0d153d3e846</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.GITHUB_ENDPOINT</strong></span> <br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									The endpoint for GitHub (Enterprise)<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="https://github.com/">https://github.com/</a></code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162228500224">
								<p>
									   <span class="strong strong"><strong>.ORG_RESTRICT</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162228499136">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162228498048">
								<p>
									If true, only users within the organization whitelist can login using this provider.
								</p>
								</td></tr></tbody></table></div></div></section><section class="section" id="google_oauth"><div class="titlepage"><div><div><h3 class="title">2.20.2. Google OAuth</h3></div></div></div><div class="table" id="idm45162226912384"><p class="title"><strong>Table 2.24. Google OAuth fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162226963616" scope="col">Field</th><th align="left" valign="top" id="idm45162226962528" scope="col">Type</th><th align="left" valign="top" id="idm45162226961440" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162226963616">
								<p>
									<span class="strong strong"><strong>FEATURE_GOOGLE_LOGIN</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226962528">
								<p>
									Boolean
								</p>
								</td><td align="left" valign="top" headers="idm45162226961440">
								<p>
									Whether Google login is supported<br/><br/> **Default: <code class="literal">False</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226963616">
								<p>
									<span class="strong strong"><strong>GOOGLE_LOGIN_CONFIG</strong></span>
								</p>
								</td><td align="left" valign="top" headers="idm45162226962528">
								<p>
									Object
								</p>
								</td><td align="left" valign="top" headers="idm45162226961440">
								<p>
									Configuration for using Google for external authentication
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226963616">
								<p>
									   <span class="strong strong"><strong>.CLIENT_ID</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162226962528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226961440">
								<p>
									The registered client ID for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">0e8dbe15c4c7630b6780</code>
								</p>
								</td></tr><tr><td align="left" valign="top" headers="idm45162226963616">
								<p>
									   <span class="strong strong"><strong>.CLIENT_SECRET</strong></span><br/>    (Required)
								</p>
								</td><td align="left" valign="top" headers="idm45162226962528">
								<p>
									String
								</p>
								</td><td align="left" valign="top" headers="idm45162226961440">
								<p>
									The registered client secret for this Red Hat Quay instance<br/><br/><span class="strong strong"><strong>Example:</strong></span> e4a58ddd3d7408b7aec109e85564a0d153d3e846
								</p>
								</td></tr></tbody></table></div></div></section></section><section class="section" id="config-fields-nested-repositories"><div class="titlepage"><div><div><h2 class="title">2.21. Configuring nested repositories</h2></div></div></div><p>
				With Red Hat Quay 3.7, support for nested repository path names has been added under the <code class="literal">FEATURE_EXTENDED_REPOSITORY_NAMES</code> property. This optional configuration must be manually added to the config.yaml by the user to enable support. Enablement allows the use of <code class="literal">/</code> in repository names.
			</p><pre class="programlisting language-yaml">FEATURE_EXTENDED_REPOSITORY_NAMES: true</pre><div class="table" id="idm45162230403632"><p class="title"><strong>Table 2.25. OCI and nested repositories configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162230397904" scope="col">Field</th><th align="left" valign="top" id="idm45162230396816" scope="col">Type</th><th align="left" valign="top" id="idm45162230395728" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162230397904">
							<p>
								<span class="strong strong"><strong>FEATURE_EXTENDED_REPOSITORY_NAMES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162230396816">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162230395728">
							<p>
								Enable support for nested repositories<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="other-oci-artifacts-with-quay"><div class="titlepage"><div><div><h2 class="title">2.22. Adding other OCI media types to Quay</h2></div></div></div><p>
				Helm, cosign, and ztsd compression scheme artifacts are built into Red Hat Quay 3.7 by default. For any other OCI media type that is not supported by default, you can add them to the <code class="literal">ALLOWED_OCI_ARTIFACT_TYPES</code> configuration in Quay’s config.yaml using the following format:
			</p><pre class="literallayout">ALLOWED_OCI_ARTIFACT_TYPES:
  &lt;oci config type 1&gt;:
  - &lt;oci layer type 1&gt;
  - &lt;oci layer type 2&gt;

  &lt;oci config type 2&gt;:
  - &lt;oci layer type 3&gt;
  - &lt;oci layer type 4&gt;
...</pre><p>
				For example, you can add Singularity (SIF) support by adding the following to your config.yaml:
			</p><pre class="literallayout">...
ALLOWED_OCI_ARTIFACT_TYPES:
  application/vnd.oci.image.config.v1+json:
  - application/vnd.dev.cosign.simplesigning.v1+json
  application/vnd.cncf.helm.config.v1+json:
  - application/tar+gzip
  application/vnd.sylabs.sif.config.v1+json:
  - application/vnd.sylabs.sif.layer.v1+tar
...</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					When adding OCI media types that are not configured by default, users will also need to manually add support for cosign and Helm if desired. The ztsd compression scheme is supported by default, so users will not need to add that OCI media type to their config.yaml to enable support.
				</p></div></div></section><section class="section" id="config-fields-mail"><div class="titlepage"><div><div><h2 class="title">2.23. Mail configuration</h2></div></div></div><div class="table" id="idm45162228178912"><p class="title"><strong>Table 2.26. Mail fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228173152" scope="col">Field</th><th align="left" valign="top" id="idm45162228172064" scope="col">Type</th><th align="left" valign="top" id="idm45162228170976" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>FEATURE_MAILING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								Whether emails are enabled<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">False</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_DEFAULT_SENDER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								If specified, the e-mail address used as the <code class="literal">from</code> when Red Hat Quay sends e-mails. If none, defaults to <code class="literal">support@quay.io</code><br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">support@example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_PASSWORD</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								The SMTP password to use when sending e-mails
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_PORT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								The SMTP port to use. If not specified, defaults to 587.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_SERVER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								The SMTP server to use for sending e-mails. Only required if FEATURE_MAILING is set to true.<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">smtp.example.com</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_USERNAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								The SMTP username to use when sending e-mails
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228173152">
							<p>
								<span class="strong strong"><strong>MAIL_USE_TLS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228172064">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228170976">
							<p>
								If specified, whether to use TLS for sending e-mails<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">True</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-user"><div class="titlepage"><div><div><h2 class="title">2.24. User configuration fields</h2></div></div></div><div class="table" id="idm45162228467760"><p class="title"><strong>Table 2.27. User configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228462000" scope="col">Field</th><th align="left" valign="top" id="idm45162228460912" scope="col">Type</th><th align="left" valign="top" id="idm45162228459824" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_SUPER_USERS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Whether superusers are supported<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_CREATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Whether users can be created (by non-superusers)<br/><br/> <span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_LAST_ACCESSED</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Whether to record the last time a user was accessed<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_LOG_ACCESS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								If set to true, users will have access to audit logs for their namespace<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_METADATA</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Whether to collect and support user metadata<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USERNAME_CONFIRMATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								If set to true, users can confirm their generated usernames<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_USER_RENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								If set to true, users can rename their own namespace<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FEATURE_INVITE_ONLY_USER_CREATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Whether users being created must be invited by another user<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>FRESH_LOGIN_TIMEOUT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								The time after which a fresh login requires users to re-enter their password<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">5m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>USERFILES_LOCATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								ID of the storage engine in which to place user-uploaded files<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">s3_us_east</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>USERFILES_PATH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								Path under storage in which to place user-uploaded files<br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">userfiles</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228462000">
							<p>
								<span class="strong strong"><strong>USER_RECOVERY_TOKEN_LIFETIME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228460912">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228459824">
							<p>
								The length of time a token for recovering a user accounts is valid<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^[0-9]+(w|m|d|h|s)$</code><br/><span class="strong strong"><strong>Default</strong></span>: <code class="literal">30m</code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-recaptcha"><div class="titlepage"><div><div><h2 class="title">2.25. Recaptcha configuration</h2></div></div></div><div class="table" id="idm45162224514576"><p class="title"><strong>Table 2.28. Recaptcha fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162224508816" scope="col">Field</th><th align="left" valign="top" id="idm45162224507728" scope="col">Type</th><th align="left" valign="top" id="idm45162224506640" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162224508816">
							<p>
								<span class="strong strong"><strong>FEATURE_RECAPTCHA</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162224507728">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162224506640">
							<p>
								Whether Recaptcha is necessary for user login and recovery<br/><br/> <span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162224508816">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162224507728">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162224506640">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162224508816">
							<p>
								<span class="strong strong"><strong>RECAPTCHA_SECRET_KEY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162224507728">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162224506640">
							<p>
								If recaptcha is enabled, the secret key for the Recaptcha service
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162224508816">
							<p>
								<span class="strong strong"><strong>RECAPTCHA_SITE_KEY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162224507728">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162224506640">
							<p>
								If recaptcha is enabled, the site key for the Recaptcha service
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-aci"><div class="titlepage"><div><div><h2 class="title">2.26. ACI configuration</h2></div></div></div><div class="table" id="idm45162228442160"><p class="title"><strong>Table 2.29. ACI configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228436400" scope="col">Field</th><th align="left" valign="top" id="idm45162228435312" scope="col">Type</th><th align="left" valign="top" id="idm45162228434224" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228436400">
							<p>
								<span class="strong strong"><strong>FEATURE_ACI_CONVERSION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228435312">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228434224">
							<p>
								Whether to enable conversion to ACIs <br/> <br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228436400">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228435312">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228434224">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228436400">
							<p>
								<span class="strong strong"><strong>GPG2_PRIVATE_KEY_FILENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228435312">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228434224">
							<p>
								The filename of the private key used to decrypte ACIs
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228436400">
							<p>
								<span class="strong strong"><strong>GPG2_PRIVATE_KEY_NAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228435312">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228434224">
							<p>
								The name of the private key used to sign ACIs
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228436400">
							<p>
								<span class="strong strong"><strong>GPG2_PUBLIC_KEY_FILENAME</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228435312">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228434224">
							<p>
								The filename of the public key used to encrypt ACIs
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-jwt"><div class="titlepage"><div><div><h2 class="title">2.27. JTW configuration</h2></div></div></div><div class="table" id="idm45162225752528"><p class="title"><strong>Table 2.30. JWT configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225746768" scope="col">Field</th><th align="left" valign="top" id="idm45162225745680" scope="col">Type</th><th align="left" valign="top" id="idm45162225744592" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225746768">
							<p>
								<span class="strong strong"><strong>JWT_AUTH_ISSUER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225745680">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225744592">
							<p>
								The endpoint for JWT users<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225746768">
							<p>
								<span class="strong strong"><strong>JWT_GETUSER_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225745680">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225744592">
							<p>
								The endpoint for JWT users<br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225746768">
							<p>
								<span class="strong strong"><strong>JWT_QUERY_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225745680">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225744592">
							<p>
								The endpoint for JWT queries<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225746768">
							<p>
								<span class="strong strong"><strong>JWT_VERIFY_ENDPOINT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225745680">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225744592">
							<p>
								The endpoint for JWT verification<br/><br/><span class="strong strong"><strong>Pattern</strong></span>: <code class="literal">^http(s)?://(.)+$</code><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal"><a class="link" href="http://192.168.99.101:6060">http://192.168.99.101:6060</a></code>
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-app-tokens"><div class="titlepage"><div><div><h2 class="title">2.28. App tokens</h2></div></div></div><div class="table" id="idm45162228315504"><p class="title"><strong>Table 2.31. App tokens configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228309776" scope="col">Field</th><th align="left" valign="top" id="idm45162228308688" scope="col">Type</th><th align="left" valign="top" id="idm45162228307600" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228309776">
							<p>
								<span class="strong strong"><strong>FEATURE_APP_SPECIFIC_TOKENS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228308688">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228307600">
							<p>
								If enabled, users can create tokens for use by the Docker CLI<br/> <br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228309776">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228308688">
							<p>
								 
							</p>
							</td><td align="left" valign="top" headers="idm45162228307600">
							<p>
								 
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228309776">
							<p>
								<span class="strong strong"><strong>APP_SPECIFIC_TOKEN_EXPIRATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228308688">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228307600">
							<p>
								The expiration for external app tokens.<br/><br/><span class="strong strong"><strong>Default</strong></span> None<br/><span class="strong strong"><strong>Pattern:</strong></span> <code class="literal">^[0-9]+(w|m|d|h|s)$</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228309776">
							<p>
								<span class="strong strong"><strong>EXPIRED_APP_SPECIFIC_TOKEN_GC</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228308688">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228307600">
							<p>
								Duration of time expired external app tokens will remain before being garbage collected<br/><br/><span class="strong strong"><strong>Default:</strong></span> 1d
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-misc"><div class="titlepage"><div><div><h2 class="title">2.29. Miscellaneous fields</h2></div></div></div><div class="table" id="idm45162228677008"><p class="title"><strong>Table 2.32. Miscellaneous fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228671248" scope="col">Field</th><th align="left" valign="top" id="idm45162228670160" scope="col">Type</th><th align="left" valign="top" id="idm45162228669072" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>ALLOW_PULLS_WITHOUT_STRICT_LOGGING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								If true, pulls will still succeed even if the pull audit log entry cannot be written . This is useful if the database is in a read-only state and it is desired for pulls to continue during that time.<br/><br/> <span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>AVATAR_KIND</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The types of avatars to display, either generated inline (local) or Gravatar (gravatar)<br/><br/> <span class="strong strong"><strong>Values:</strong></span> local, gravatar
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>BROWSER_API_CALLS_XHR_ONLY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								If enabled, only API calls marked as being made by an XHR will be allowed from browsers<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>DEFAULT_NAMESPACE_MAXIMUM_BUILD_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The default maximum number of builds that can be queued in a namespace.<br/><br/><span class="strong strong"><strong>Default:</strong></span> None
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>ENABLE_HEALTH_DEBUG_SECRET</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								If specified, a secret that can be given to health endpoints to see full debug info when not authenticated as a superuser
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>EXTERNAL_TLS_TERMINATION</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								Set to <code class="literal">true</code> if TLS is supported, but terminated at a layer before Quay. Set to <code class="literal">false</code> when Quay is running with its own SSL certificates and receiving TLS traffic directly.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>FRESH_LOGIN_TIMEOUT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The time after which a fresh login requires users to re-enter their password<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">5m</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>HEALTH_CHECKER</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The configured health check<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">('RDSAwareHealthCheck', {'access_key': 'foo', 'secret_key': 'bar'})</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>PROMETHEUS_NAMESPACE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The prefix applied to all exposed Prometheus metrics<br/><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">quay</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>PUBLIC_NAMESPACES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								If a namespace is defined in the public namespace list, then it will appear on <span class="strong strong"><strong>all</strong></span> users' repository list pages, regardless of whether the user is a member of the namespace. Typically, this is used by an enterprise customer in configuring a set of "well-known" namespaces.
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>REGISTRY_STATE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The state of the registry<br/><br/><span class="strong strong"><strong>Values:</strong></span> <code class="literal">normal</code> or <code class="literal">read-only</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>SEARCH_MAX_RESULT_PAGE_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								Maximum number of pages the user can paginate in search before they are limited<br/><br/><span class="strong strong"><strong>Default:</strong></span> 10
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>SEARCH_RESULTS_PER_PAGE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								Number of results returned per page by search page<br/><br/><span class="strong strong"><strong>Default:</strong></span> 10
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>V1_PUSH_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The array of namespace names that support V1 push if FEATURE_RESTRICTED_V1_PUSH is set to true
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>V2_PAGINATION_SIZE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The number of results returned per page in V2 registry APIs
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>WEBHOOK_HOSTNAME_BLACKLIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								The set of hostnames to disallow from webhooks when validating, beyond localhost
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>CREATE_PRIVATE_REPO_ON_PUSH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								Whether new repositories created by push are set to private visibility<br/><br/><span class="strong strong"><strong>Default:</strong></span> True
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>CREATE_NAMESPACE_ON_PUSH</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								Whether new push to a non-existent organization creates it<br/><br/><span class="strong strong"><strong>Default:</strong></span> False
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162228671248">
							<p>
								<span class="strong strong"><strong>NON_RATE_LIMITED_NAMESPACES</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228670160">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162228669072">
							<p>
								If rate limiting has been enabled using <code class="literal">FEATURE_RATE_LIMITS</code>, you can override it for specific namespace that require unlimited access.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-fields-legacy"><div class="titlepage"><div><div><h2 class="title">2.30. Legacy configuration fields</h2></div></div></div><p>
				Some fields are deprecated or obsolete:
			</p><div class="table" id="idm45162225329712"><p class="title"><strong>Table 2.33. Legacy fields</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225323952" scope="col">Field</th><th align="left" valign="top" id="idm45162225322864" scope="col">Type</th><th align="left" valign="top" id="idm45162225321776" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225323952">
							<p>
								<span class="strong strong"><strong>FEATURE_BLACKLISTED_EMAILS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225322864">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162225321776">
							<p>
								If set to true, no new User accounts may be created if their email domain is blacklisted
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225323952">
							<p>
								<span class="strong strong"><strong>BLACKLISTED_EMAIL_DOMAINS</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225322864">
							<p>
								Array of String
							</p>
							</td><td align="left" valign="top" headers="idm45162225321776">
							<p>
								The list of email-address domains that is used if FEATURE_BLACKLISTED_EMAILS is set to true<br/><br/><span class="strong strong"><strong>Example:</strong></span> <code class="literal">"example.com", "example.org"</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225323952">
							<p>
								<span class="strong strong"><strong>BLACKLIST_V2_SPEC</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225322864">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225321776">
							<p>
								The Docker CLI versions to which Red Hat Quay will respond that V2 is <span class="strong strong"><strong>unsupported</strong></span><br/><br/><span class="strong strong"><strong>Example</strong></span>: <code class="literal">&lt;1.8.0</code><br/><span class="strong strong"><strong>Default:</strong></span> <code class="literal">&lt;1.6.0</code>
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225323952">
							<p>
								<span class="strong strong"><strong>DOCUMENTATION_ROOT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225322864">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225321776">
							<p>
								Root URL for documentation links
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225323952">
							<p>
								<span class="strong strong"><strong>SECURITY_SCANNER_V4_NAMESPACE_WHITELIST</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225322864">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162225321776">
							<p>
								The namespaces for which the security scanner should be enabled
							</p>
							</td></tr></tbody></table></div></div></section></section><section class="chapter" id="config-envar-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Environment variables</h1></div></div></div><p>
			Red Hat Quay supports a limited number of environment variables for dynamic configuration.
		</p><section class="section" id="config-envvar-georepl"><div class="titlepage"><div><div><h2 class="title">3.1. Geo-replication</h2></div></div></div><p>
				The exact same configuration should be used across all regions, with exception of the storage backend, which can be configured explicitly using the <code class="literal">QUAY_DISTRIBUTED_STORAGE_PREFERENCE</code> environment variable.
			</p><div class="table" id="idm45162228527376"><p class="title"><strong>Table 3.1. Geo-replication configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162228521600" scope="col">Variable</th><th align="left" valign="top" id="idm45162228520512" scope="col">Type</th><th align="left" valign="top" id="idm45162228519424" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162228521600">
							<p>
								<span class="strong strong"><strong>QUAY_DISTRIBUTED_STORAGE_PREFERENCE</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162228520512">
							<p>
								String
							</p>
							</td><td align="left" valign="top" headers="idm45162228519424">
							<p>
								The preferred storage engine (by ID in DISTRIBUTED_STORAGE_CONFIG) to use.
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-envvar-dbpool"><div class="titlepage"><div><div><h2 class="title">3.2. Database connection pooling</h2></div></div></div><p>
				Red Hat Quay is composed of many different processes which all run within the same container. Many of these processes interact with the database.
			</p><p>
				If enabled, each process that interacts with the database will contain a connection pool. These per-process connection pools are configured to maintain a maximum of 20 connections. Under heavy load, it is possible to fill the connection pool for every process within a Red Hat Quay container. Under certain deployments and loads, this may require analysis to ensure Red Hat Quay does not exceed the database’s configured maximum connection count.
			</p><p>
				Overtime, the connection pools will release idle connections. To release all connections immediately, Red Hat Quay requires a restart.
			</p><p>
				Database connection pooling may be toggled by setting the environment variable DB_CONNECTION_POOLING={true|false}
			</p><div class="table" id="idm45162225715568"><p class="title"><strong>Table 3.2. Database connection pooling configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225709840" scope="col">Variable</th><th align="left" valign="top" id="idm45162225708752" scope="col">Type</th><th align="left" valign="top" id="idm45162225707664" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225709840">
							<p>
								<span class="strong strong"><strong>DB_CONNECTION_POOLING</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225708752">
							<p>
								Boolean
							</p>
							</td><td align="left" valign="top" headers="idm45162225707664">
							<p>
								Enable or disable database connection pooling
							</p>
							</td></tr></tbody></table></div></div><p>
				If database connection pooling is enabled, it is possible to change the maximum size of the connection pool. This can be done through the following config.yaml option:
			</p><div class="formalpara"><p class="title"><strong>config.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">...
DB_CONNECTION_ARGS:
  max_connections: 10
...</pre>
				</p></div></section><section class="section" id="config-envvar-worker-connection"><div class="titlepage"><div><div><h2 class="title">3.3. HTTP connection counts</h2></div></div></div><p>
				It is possible to specify the quantity of simultaneous HTTP connections using environment variables. These can be specified as a whole, or for a specific component. The default for each is 50 parallel connections per process.
			</p><div class="table" id="idm45162225694416"><p class="title"><strong>Table 3.3. HTTP connection counts configuration</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162225688688" scope="col">Variable</th><th align="left" valign="top" id="idm45162225687600" scope="col">Type</th><th align="left" valign="top" id="idm45162225686512" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162225688688">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225687600">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162225686512">
							<p>
								Simultaneous HTTP connections <br/><br/><span class="strong strong"><strong>Default:</strong></span> 50
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225688688">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_REGISTRY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225687600">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162225686512">
							<p>
								Simultaneous HTTP connections for registry<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225688688">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_WEB</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225687600">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162225686512">
							<p>
								Simultaneous HTTP connections for web UI<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162225688688">
							<p>
								<span class="strong strong"><strong>WORKER_CONNECTION_COUNT_SECSCAN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162225687600">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162225686512">
							<p>
								Simultaneous HTTP connections for Clair<br/><br/><span class="strong strong"><strong>Default:</strong></span> WORKER_CONNECTION_COUNT
							</p>
							</td></tr></tbody></table></div></div></section><section class="section" id="config-envvar-worker-count"><div class="titlepage"><div><div><h2 class="title">3.4. Worker count variables</h2></div></div></div><div class="table" id="idm45162227549984"><p class="title"><strong>Table 3.4. Worker count variables</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"/><col style="width: 17%; " class="col_2"/><col style="width: 33%; " class="col_3"/></colgroup><thead><tr><th align="left" valign="top" id="idm45162227544224" scope="col">Variable</th><th align="left" valign="top" id="idm45162227543136" scope="col">Type</th><th align="left" valign="top" id="idm45162227542048" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm45162227544224">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227543136">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162227542048">
							<p>
								Generic override for number of processes
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227544224">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_REGISTRY</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227543136">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162227542048">
							<p>
								Specifies the number of processes to handle Registry requests within the <code class="literal">Quay</code> container<br/><br/><span class="strong strong"><strong>Values:</strong></span> Integer between 8 and 64
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227544224">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_WEB</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227543136">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162227542048">
							<p>
								Specifies the number of processes to handle UI/Web requests within the container<br/><br/> <span class="strong strong"><strong>Values:</strong></span> Integer between 2 and 32
							</p>
							</td></tr><tr><td align="left" valign="top" headers="idm45162227544224">
							<p>
								<span class="strong strong"><strong>WORKER_COUNT_SECSCAN</strong></span>
							</p>
							</td><td align="left" valign="top" headers="idm45162227543136">
							<p>
								Number
							</p>
							</td><td align="left" valign="top" headers="idm45162227542048">
							<p>
								Specifies the number of processes to handle Security Scanning (e.g. Clair) integration within the container<br/><br/><span class="strong strong"><strong>Values:</strong></span> Integer between 2 and 4
							</p>
							</td></tr></tbody></table></div></div></section></section><section class="chapter" id="operator-config-ui"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Using the config tool to reconfigure Quay on OpenShift</h1></div></div></div><section class="section" id="operator-config-ui-access"><div class="titlepage"><div><div><h2 class="title">4.1. Accessing the config editor</h2></div></div></div><p>
				In the Details section of the QuayRegistry screen, the endpoint for the config editor is available, along with a link to the secret containing the credentials for logging into the config editor:
			</p><p>
				<span class="inlinemediaobject"><img src="images/config-editor-details-openshift.png" alt="Config editor details"/></span>
			</p><section class="section" id="retrieving_the_config_editor_credentials"><div class="titlepage"><div><div><h3 class="title">4.1.1. Retrieving the config editor credentials</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Click on the link for the config editor secret:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-secret.png" alt="Config editor secret"/></span>
						</p></li><li class="listitem"><p class="simpara">
							In the Data section of the Secret details screen, click <code class="literal">Reveal values</code> to see the credentials for logging in to the config editor:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-secret-reveal.png" alt="Config editor secret reveal"/></span>
						</p></li></ol></div></section><section class="section" id="logging_in_to_the_config_editor"><div class="titlepage"><div><div><h3 class="title">4.1.2. Logging in to the config editor</h3></div></div></div><p>
					Browse to the config editor endpoint and then enter the username, typically <code class="literal">quayconfig</code>, and the corresponding password to access the config tool:
				</p><p>
					<span class="inlinemediaobject"><img src="images/config-editor-ui.png" alt="Config editor user interface"/></span>
				</p></section><section class="section" id="operator-config-ui-change"><div class="titlepage"><div><div><h3 class="title">4.1.3. Changing configuration</h3></div></div></div><p>
					In this example of updating the configuration, a superuser is added via the config editor tool:
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Add an expiration period, for example <code class="literal">4w</code>, for the time machine functionality:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/ui-time-machine-add.png" alt="Add expiration period"/></span>
						</p></li><li class="listitem">
							Select <code class="literal">Validate Configuration Changes</code> to ensure that the changes are valid
						</li><li class="listitem"><p class="simpara">
							Apply the changes by pressing the <code class="literal">Reconfigure Quay</code> button:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-reconfigure.png" alt="Reconfigure"/></span>
						</p></li><li class="listitem"><p class="simpara">
							The config tool notifies you that the change has been submitted to Quay:
						</p><p class="simpara">
							<span class="inlinemediaobject"><img src="images/config-editor-reconfigured.png" alt="Reconfigured"/></span>
						</p></li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						Reconfiguring Red Hat Quay using the config tool UI can lead to the registry being unavailable for a short time, while the updated configuration is applied.
					</p></div></div></section></section><section class="section" id="operator-config-ui-monitoring"><div class="titlepage"><div><div><h2 class="title">4.2. Monitoring reconfiguration in the UI</h2></div></div></div><section class="section" id="quayregistry_resource"><div class="titlepage"><div><div><h3 class="title">4.2.1. QuayRegistry resource</h3></div></div></div><p>
					After reconfiguring the Operator, you can track the progress of the redeployment in the YAML tab for the specific instance of QuayRegistry, in this case, <code class="literal">example-registry</code>:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-update.png" alt="ui monitor deploy update"/></span>
				</p><p>
					Each time the status changes, you will be prompted to reload the data to see the updated version. Eventually, the Operator will reconcile the changes, and there will be no unhealthy components reported.
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-done.png" alt="ui monitor deploy done"/></span>
				</p></section><section class="section" id="events"><div class="titlepage"><div><div><h3 class="title">4.2.2. Events</h3></div></div></div><p>
					The Events tab for the QuayRegistry shows some events related to the redeployment:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-streaming-events.png" alt="ui monitor deploy streaming events"/></span>
				</p><p>
					Streaming events, for all resources in the namespace that are affected by the reconfiguration, are available in the OpenShift console under Home → Events:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-monitor-deploy-streaming-events.png" alt="ui monitor deploy streaming events"/></span>
				</p></section></section><section class="section" id="operator-config-ui-updated"><div class="titlepage"><div><div><h2 class="title">4.3. Accessing updated information after reconfiguration</h2></div></div></div><section class="section" id="accessing_the_updated_config_tool_credentials_in_the_ui"><div class="titlepage"><div><div><h3 class="title">4.3.1. Accessing the updated config tool credentials in the UI</h3></div></div></div><p>
					Since a new pod has been created for the config tool, a new secret will have been created, and you will need to use the updated password when you next attempt to login:
				</p><p>
					<span class="inlinemediaobject"><img src="images/config-editor-secret-updated.png" alt="Config editor secret updated"/></span>
				</p></section><section class="section" id="accessing_the_updated_config_yaml_in_the_ui"><div class="titlepage"><div><div><h3 class="title">4.3.2. Accessing the updated config.yaml in the UI</h3></div></div></div><p>
					Use the config bundle to access the updated <code class="literal">config.yaml</code> file.
				</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							On the QuayRegistry details screen, click on the Config Bundle Secret
						</li><li class="listitem">
							In the Data section of the Secret details screen, click Reveal values to see the <code class="literal">config.yaml</code> file
						</li><li class="listitem"><p class="simpara">
							Check that the change has been applied. In this case, <code class="literal">4w</code> should be in the list of <code class="literal">TAG_EXPIRATION_OPTIONS</code>:
						</p><pre class="programlisting language-yaml">...
SERVER_HOSTNAME: example-quay-openshift-operators.apps.docs.quayteam.org
SETUP_COMPLETE: true
SUPER_USERS:
- quayadmin
TAG_EXPIRATION_OPTIONS:
- 2w
- 4w
...</pre></li></ol></div></section></section></section><section class="chapter" id="operator-components-intro"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Quay Operator components</h1></div></div></div><p>
			Quay is a powerful container registry platform and as a result, has a significant number of dependencies. These include a database, object storage, Redis, and others. The Quay Operator manages an opinionated deployment of Quay and its dependencies on Kubernetes. These dependencies are treated as <span class="emphasis"><em>components</em></span> and are configured through the <code class="literal">QuayRegistry</code> API.
		</p><p>
			In the <code class="literal">QuayRegistry</code> custom resource, the <code class="literal">spec.components</code> field configures components. Each component contains two fields: <code class="literal">kind</code> - the name of the component, and <code class="literal">managed</code> - boolean whether the component lifecycle is handled by the Operator. By default (omitting this field), all components are managed and will be autofilled upon reconciliation for visibility:
		</p><pre class="programlisting language-yaml">spec:
  components:
    - managed: true
      kind: clair
    - managed: true
      kind: postgres
    - managed: true
      kind: objectstorage
    - managed: true
      kind: redis
    - managed: true
      kind: horizontalpodautoscaler
    - managed: true
      kind: route
    - managed: true
      kind: mirror
    - managed: true
      kind: monitoring
    - managed: true
      kind: tls</pre><section class="section" id="operator-components-managed"><div class="titlepage"><div><div><h2 class="title">5.1. Using managed components</h2></div></div></div><p>
				Unless your <code class="literal">QuayRegistry</code> custom resource specifies otherwise, the Operator will use defaults for the following managed components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>postgres:</strong></span> For storing the registry metadata, uses a version of Postgres 10 from the <a class="link" href="https://www.softwarecollections.org/en/">Software Collections</a>
					</li><li class="listitem">
						<span class="strong strong"><strong>redis:</strong></span> Handles Quay builder coordination and some internal logging
					</li><li class="listitem">
						<span class="strong strong"><strong>objectstorage:</strong></span> For storing image layer blobs, utilizes the <code class="literal">ObjectBucketClaim</code> Kubernetes API which is provided by Noobaa/RHOCS
					</li><li class="listitem">
						<span class="strong strong"><strong>clair:</strong></span> Provides image vulnerability scanning
					</li><li class="listitem">
						<span class="strong strong"><strong>horizontalpodautoscaler:</strong></span> Adjusts the number of Quay pods depending on memory/cpu consumption
					</li><li class="listitem">
						<span class="strong strong"><strong>mirror:</strong></span> Configures repository mirror workers (to support optional repository mirroring)
					</li><li class="listitem">
						<span class="strong strong"><strong>route:</strong></span> Provides an external entrypoint to the Quay registry from outside OpenShift
					</li><li class="listitem">
						<span class="strong strong"><strong>monitoring:</strong></span> Features include a Grafana dashboard, access to individual metrics, and alerting to notify for frequently restarting Quay pods
					</li><li class="listitem">
						<span class="strong strong"><strong>tls:</strong></span> Configures whether Red Hat Quay or OpenShift handles TLS
					</li></ul></div><p>
				The Operator will handle any required configuration and installation work needed for Red Hat Quay to use the managed components. If the opinionated deployment performed by the Quay Operator is unsuitable for your environment, you can provide the Operator with <code class="literal">unmanaged</code> resources (overrides) as described in the following sections.
			</p></section><section class="section" id="operator-components-unmanaged"><div class="titlepage"><div><div><h2 class="title">5.2. Using unmanaged components for dependencies</h2></div></div></div><p>
				If you have existing components such as Postgres, Redis or object storage that you would like to use with Quay, you first configure them within the Quay configuration bundle (<code class="literal">config.yaml</code>) and then reference the bundle in your <code class="literal">QuayRegistry</code> (as a Kubernetes <code class="literal">Secret</code>) while indicating which components are unmanaged.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The Quay config editor can also be used to create or modify an existing config bundle and simplifies the process of updating the Kubernetes <code class="literal">Secret</code>, especially for multiple changes. When Quay’s configuration is changed via the config editor and sent to the Operator, the Quay deployment will be updated to reflect the new configuration.
				</p></div></div><section class="section" id="operator-unmanaged-postgres"><div class="titlepage"><div><div><h3 class="title">5.2.1. Using an existing Postgres database</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a configuration file <code class="literal">config.yaml</code> with the necessary database fields:
						</p><div class="formalpara"><p class="title"><strong>config.yaml:</strong></p><p>
								
<pre class="programlisting language-yaml">DB_URI: postgresql://test-quay-database:postgres@test-quay-database:5432/test-quay-database</pre>
							</p></div></li><li class="listitem"><p class="simpara">
							Create a Secret using the configuration file:
						</p><pre class="screen">$ kubectl create secret generic --from-file config.yaml=./config.yaml config-bundle-secret</pre></li><li class="listitem"><p class="simpara">
							Create a QuayRegistry YAML file <code class="literal">quayregistry.yaml</code> which marks the <code class="literal">postgres</code> component as unmanaged and references the created Secret:
						</p><div class="formalpara"><p class="title"><strong>quayregistry.yaml</strong></p><p>
								
<pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: config-bundle-secret
  components:
    - kind: postgres
      managed: false</pre>
							</p></div></li><li class="listitem">
							Deploy the registry as detailed in the following sections.
						</li></ol></div></section><section class="section" id="operator-unmanaged-storage-noobaa"><div class="titlepage"><div><div><h3 class="title">5.2.2. NooBaa unmanaged storage</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Create a NooBaa Object Bucket Claim in the console at Storage → Object Bucket Claims.
						</li><li class="listitem">
							Retrieve the Object Bucket Claim Data details including the Access Key, Bucket Name, Endpoint (hostname) and Secret Key.
						</li><li class="listitem"><p class="simpara">
							Create a <code class="literal">config.yaml</code> configuration file, using the information for the Object Bucket Claim:
						</p><pre class="screen">DISTRIBUTED_STORAGE_CONFIG:
  default:
    - RHOCSStorage
    - access_key: WmrXtSGk8B3nABCDEFGH
      bucket_name: my-noobaa-bucket-claim-8b844191-dc6c-444e-9ea4-87ece0abcdef
      hostname: s3.openshift-storage.svc.cluster.local
      is_secure: true
      port: "443"
      secret_key: X9P5SDGJtmSuHFCMSLMbdNCMfUABCDEFGH+C5QD
      storage_path: /datastorage/registry
DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
DISTRIBUTED_STORAGE_PREFERENCE:
  - default</pre></li></ol></div></section><section class="section" id="operator-unmanaged-hpa"><div class="titlepage"><div><div><h3 class="title">5.2.3. Disabling the Horizontal Pod Autoscaler</h3></div></div></div><p>
					<code class="literal">HorizontalPodAutoscalers</code> have been added to the Clair, Quay, and Mirror pods, so that they now automatically scale during load spikes.
				</p><p>
					As HPA is configured by default to be <code class="literal">managed</code>, the number of pods for Quay, Clair and repository mirroring is set to two. This facilitates the avoidance of downtime when updating / reconfiguring Quay via the Operator or during rescheduling events.
				</p><p>
					If you wish to disable autoscaling or create your own <code class="literal">HorizontalPodAutoscaler</code>, simply specify the component as unmanaged in the <code class="literal">QuayRegistry</code> instance:
				</p><pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  components:
    - kind: horizontalpodautoscaler
      managed: false</pre></section></section><section class="section" id="config-custom-ssl-cert-kubernetes"><div class="titlepage"><div><div><h2 class="title">5.3. Add certs when deployed on Kubernetes</h2></div></div></div><p>
				When deployed on Kubernetes, Red Hat Quay mounts in a secret as a volume to store config assets. Unfortunately, this currently breaks the upload certificate function of the superuser panel.
			</p><p>
				To get around this error, a base64 encoded certificate can be added to the secret <span class="emphasis"><em>after</em></span> Red Hat Quay has been deployed. Here’s how:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Begin by base64 encoding the contents of the certificate:
					</p><pre class="screen">$ cat ca.crt
-----BEGIN CERTIFICATE-----
MIIDljCCAn6gAwIBAgIBATANBgkqhkiG9w0BAQsFADA5MRcwFQYDVQQKDA5MQUIu
TElCQ09SRS5TTzEeMBwGA1UEAwwVQ2VydGlmaWNhdGUgQXV0aG9yaXR5MB4XDTE2
MDExMjA2NTkxMFoXDTM2MDExMjA2NTkxMFowOTEXMBUGA1UECgwOTEFCLkxJQkNP
UkUuU08xHjAcBgNVBAMMFUNlcnRpZmljYXRlIEF1dGhvcml0eTCCASIwDQYJKoZI
[...]
-----END CERTIFICATE-----

$ cat ca.crt | base64 -w 0
[...]
c1psWGpqeGlPQmNEWkJPMjJ5d0pDemVnR2QNCnRsbW9JdEF4YnFSdVd3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">kubectl</code> tool to edit the quay-enterprise-config-secret.
					</p><pre class="screen">$ kubectl --namespace quay-enterprise edit secret/quay-enterprise-config-secret</pre></li><li class="listitem"><p class="simpara">
						Add an entry for the cert and paste the full base64 encoded string under the entry:
					</p><pre class="screen">  custom-cert.crt:
c1psWGpqeGlPQmNEWkJPMjJ5d0pDemVnR2QNCnRsbW9JdEF4YnFSdVd3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=</pre></li><li class="listitem">
						Finally, recycle all Red Hat Quay pods. Use <code class="literal">kubectl delete</code> to remove all Red Hat Quay pods. The Red Hat Quay Deployment will automatically schedule replacement pods with the new certificate data.
					</li></ol></div></section><section class="section" id="operator-helm-oci"><div class="titlepage"><div><div><h2 class="title">5.4. Configuring OCI and Helm with the Operator</h2></div></div></div><p>
				Customizations to the configuration of Quay can be provided in a secret containing the configuration bundle. Execute the following command which will create a new secret called <code class="literal">quay-config-bundle</code>, in the appropriate namespace, containing the necessary properties to enable OCI support.
			</p><div class="formalpara"><p class="title"><strong>quay-config-bundle.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: v1
stringData:
  config.yaml: |
    FEATURE_GENERAL_OCI_SUPPORT: true
    FEATURE_HELM_OCI_SUPPORT: true
kind: Secret
metadata:
  name: quay-config-bundle
  namespace: quay-enterprise
type: Opaque</pre>
				</p></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					As of Red Hat Quay 3.7, <code class="literal">FEATURE_HELM_OCI_SUPPORT</code> has been deprecated and will be removed in a future version of Red Hat Quay. In Red Hat Quay 3.7, Helm artifacts are supported by default and included under the <code class="literal">FEATURE_GENERAL_OCI_SUPPORT</code> property. Users are no longer required to update their config.yaml files to enable support.
				</p></div></div><p>
				Create the secret in the appropriate namespace, in this example <code class="literal">quay-enterprise</code>:
			</p><pre class="screen">$ oc create -n quay-enterprise -f quay-config-bundle.yaml</pre><p>
				Specify the secret for the <code class="literal">spec.configBundleSecret</code> field:
			</p><div class="formalpara"><p class="title"><strong>quay-registry.yaml</strong></p><p>
					
<pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: example-registry
  namespace: quay-enterprise
spec:
  configBundleSecret: quay-config-bundle</pre>
				</p></div><p>
				Create the registry with the specified configuration:
			</p><pre class="screen">$ oc create -n quay-enterprise -f quay-registry.yaml</pre></section><section class="section" id="operator-volume-size-overrides"><div class="titlepage"><div><div><h2 class="title">5.5. Volume size overrides</h2></div></div></div><p>
				As of Red Hat Quay v3.6.2, you can specify the desired size of storage resources provisioned for managed components. The default size for Clair and Quay PostgreSQL databases is <code class="literal">50Gi</code>. You can now choose a large enough capacity upfront, either for performance reasons or in the case where your storage backend does not have resize capability.
			</p><p>
				In the following example, the volume size for the Clair and the Quay PostgreSQL databases has been set to <code class="literal">70Gi</code>:
			</p><pre class="programlisting language-yaml">apiVersion: quay.redhat.com/v1
kind: QuayRegistry
metadata:
  name: quay-example
  namespace: quay-enterprise
spec:
  configBundleSecret: config-bundle-secret
  components:
    - kind: objectstorage
      managed: false
    - kind: route
      managed: true
    - kind: tls
      managed: false
    - kind: clair
      managed: true
      overrides:
        volumeSize: 70Gi
    - kind: postgres
      managed: true
      overrides:
        volumeSize: 70Gi</pre></section></section><section class="chapter" id="using_the_configuration_api"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Using the configuration API</h1></div></div></div><p>
			The configuration tool exposes 4 endpoints that can be used to build, validate, bundle and deploy a configuration. The config-tool API is documented at <a class="link" href="https://github.com/quay/config-tool/blob/master/pkg/lib/editor/API.md">https://github.com/quay/config-tool/blob/master/pkg/lib/editor/API.md</a>. In this section, you will see how to use the API to retrieve the current configuration and how to validate any changes you make.
		</p><section class="section" id="retrieving_the_default_configuration"><div class="titlepage"><div><div><h2 class="title">6.1. Retrieving the default configuration</h2></div></div></div><p>
				If you are running the configuration tool for the first time, and do not have an existing configuration, you can retrieve the default configuration. Start the container in config mode:
			</p><pre class="literallayout">$ sudo podman run --rm -it --name quay_config \
  -p 8080:8080 \
  registry.redhat.io/quay/quay-rhel8:v3.7.0 config secret</pre><p>
				Use the <code class="literal">config</code> endpoint of the configuration API to get the default:
			</p><pre class="literallayout">$ curl -X GET -u quayconfig:secret http://quay-server:8080/api/v1/config  | jq</pre><p>
				The value returned is the default configuration in JSON format:
			</p><pre class="programlisting language-json">{
  "config.yaml": {
    "AUTHENTICATION_TYPE": "Database",
    "AVATAR_KIND": "local",
    "DB_CONNECTION_ARGS": {
      "autorollback": true,
      "threadlocals": true
    },
    "DEFAULT_TAG_EXPIRATION": "2w",
    "EXTERNAL_TLS_TERMINATION": false,
    "FEATURE_ACTION_LOG_ROTATION": false,
    "FEATURE_ANONYMOUS_ACCESS": true,
    "FEATURE_APP_SPECIFIC_TOKENS": true,
    ....
  }

}</pre></section><section class="section" id="retrieving_the_current_configuration"><div class="titlepage"><div><div><h2 class="title">6.2. Retrieving the current configuration</h2></div></div></div><p>
				If you have already configured and deployed the Quay registry, stop the container and restart it in configuration mode, loading the existing configuration as a volume:
			</p><pre class="literallayout">$ sudo podman run --rm -it --name quay_config \
  -p 8080:8080 \
  -v $QUAY/config:/conf/stack:Z \
  registry.redhat.io/quay/quay-rhel8:v3.7.0 config secret</pre><p>
				Use the <code class="literal">config</code> endpoint of the API to get the current configuration:
			</p><pre class="literallayout">$ curl -X GET -u quayconfig:secret http://quay-server:8080/api/v1/config  | jq</pre><p>
				The value returned is the current configuration in JSON format, including database and Redis configuration data:
			</p><pre class="programlisting language-json">{
  "config.yaml": {
    ....
    "BROWSER_API_CALLS_XHR_ONLY": false,
    "BUILDLOGS_REDIS": {
      "host": "quay-server",
      "password": "strongpassword",
      "port": 6379
    },
    "DATABASE_SECRET_KEY": "4b1c5663-88c6-47ac-b4a8-bb594660f08b",
    "DB_CONNECTION_ARGS": {
      "autorollback": true,
      "threadlocals": true
    },
    "DB_URI": "postgresql://quayuser:quaypass@quay-server:5432/quay",
    "DEFAULT_TAG_EXPIRATION": "2w",
    ....


  }

}</pre></section><section class="section" id="validating_configuration_using_the_api"><div class="titlepage"><div><div><h2 class="title">6.3. Validating configuration using the API</h2></div></div></div><p>
				You can validate a configuration by posting it to the <code class="literal">config/validate</code> endpoint:
			</p><pre class="literallayout">curl -u quayconfig:secret --header 'Content-Type: application/json' --request POST --data '
{
  "config.yaml": {
    ....
    "BROWSER_API_CALLS_XHR_ONLY": false,
    "BUILDLOGS_REDIS": {
      "host": "quay-server",
      "password": "strongpassword",
      "port": 6379
    },
    "DATABASE_SECRET_KEY": "4b1c5663-88c6-47ac-b4a8-bb594660f08b",
    "DB_CONNECTION_ARGS": {
      "autorollback": true,
      "threadlocals": true
    },
    "DB_URI": "postgresql://quayuser:quaypass@quay-server:5432/quay",
    "DEFAULT_TAG_EXPIRATION": "2w",
    ....

  }

} http://quay-server:8080/api/v1/config/validate | jq</pre><p>
				The returned value is an array containing the errors found in the configuration. If the configuration is valid, an empty array <code class="literal">[]</code> is returned.
			</p></section><section class="section" id="determining_the_required_fields"><div class="titlepage"><div><div><h2 class="title">6.4. Determining the required fields</h2></div></div></div><p>
				You can determine the required fields by posting an empty configuration structure to the <code class="literal">config/validate</code> endpoint:
			</p><pre class="literallayout">curl -u quayconfig:secret --header 'Content-Type: application/json' --request POST --data '
{
  "config.yaml": {
  }

} http://quay-server:8080/api/v1/config/validate | jq</pre><p>
				The value returned is an array indicating which fields are required:
			</p><pre class="programlisting language-yaml">[
  {
    "FieldGroup": "Database",
    "Tags": [
      "DB_URI"
    ],
    "Message": "DB_URI is required."
  },
  {
    "FieldGroup": "DistributedStorage",
    "Tags": [
      "DISTRIBUTED_STORAGE_CONFIG"
    ],
    "Message": "DISTRIBUTED_STORAGE_CONFIG must contain at least one storage location."
  },
  {
    "FieldGroup": "HostSettings",
    "Tags": [
      "SERVER_HOSTNAME"
    ],
    "Message": "SERVER_HOSTNAME is required"
  },
  {
    "FieldGroup": "HostSettings",
    "Tags": [
      "SERVER_HOSTNAME"
    ],
    "Message": "SERVER_HOSTNAME must be of type Hostname"
  },
  {
    "FieldGroup": "Redis",
    "Tags": [
      "BUILDLOGS_REDIS"
    ],
    "Message": "BUILDLOGS_REDIS is required"
  }
]</pre></section></section><section class="chapter" id="using_the_configuration_tool"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Using the configuration tool</h1></div></div></div><section class="section" id="config-ui-custom-ssl-certs"><div class="titlepage"><div><div><h2 class="title">7.1. Custom SSL certificates UI</h2></div></div></div><p>
				The config tool can be used to load custom certificates to facilitate access to resources such as external databases. Select the custom certs to be uploaded, ensuring that they are in PEM format, with an extension <code class="literal">.crt</code>.
			</p><p>
				<span class="inlinemediaobject"><img src="images/ui-custom-ssl-certs.png" alt="Custom SSL certificates"/></span>
			</p><p>
				The config tool also displays a list of any uploaded certificates. Once you upload your custom SSL cert, it will appear in the list:
			</p><p>
				<span class="inlinemediaobject"><img src="images/ui-custom-ssl-certs-uploaded.png" alt="Custom SSL certificates"/></span>
			</p></section><section class="section" id="config-ui-basic-config"><div class="titlepage"><div><div><h2 class="title">7.2. Basic configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-basic-config.png" alt="Basic configuration"/></span>
			</p><section class="section" id="contact_information"><div class="titlepage"><div><div><h3 class="title">7.2.1. Contact information</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-basic-config-contact-info.png" alt="Basic configuration"/></span>
				</p></section></section><section class="section" id="config-ui-server-config"><div class="titlepage"><div><div><h2 class="title">7.3. Server configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-server-config-no-tls.png" alt="Server configuration"/></span>
			</p><section class="section" id="server_configuration_choice"><div class="titlepage"><div><div><h3 class="title">7.3.1. Server configuration choice</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-server-config-tls-choice.png" alt="Server configuration choice"/></span>
				</p></section><section class="section" id="tls_configuration"><div class="titlepage"><div><div><h3 class="title">7.3.2. TLS configuration</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-server-config-tls.png" alt="TLS configuration"/></span>
				</p></section></section><section class="section" id="config-ui-database"><div class="titlepage"><div><div><h2 class="title">7.4. Database configuration</h2></div></div></div><p>
				You can choose between PostGreSQL and MySQL: 
				<span class="inlinemediaobject"><img src="images/ui-database-choice.png" alt="Database choice"/></span>
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					The MySQL and MariaDB databases have been deprecated as of Red Hat Quay 3.6. Support for these databases will be removed in a future version of Red Hat Quay. If starting a new Red Hat Quay installation, it is strongly recommended to use PostgreSQL.
				</p></div></div><section class="section" id="postgresql_configuration"><div class="titlepage"><div><div><h3 class="title">7.4.1. PostgreSQL configuration</h3></div></div></div><p>
					Enter the details for connecting to the database:
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-database-postgres.png" alt="PostgreSQL configuration"/></span>
				</p><p>
					This will generate a DB_URI field of the form <code class="literal">postgresql://quayuser:quaypass@quay-server.example.com:5432/quay</code>.
				</p><p>
					If you need finer-grained control of the connection arguments, see the section "Database connection arguments" in the Configuration Guide.
				</p></section></section><section class="section" id="config-ui-data-consistency"><div class="titlepage"><div><div><h2 class="title">7.5. Data consistency</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-data-consistency.png" alt="Data consistency"/></span>
			</p></section><section class="section" id="config-ui-time-machine"><div class="titlepage"><div><div><h2 class="title">7.6. Time machine configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-time-machine.png" alt="Time machine configuration"/></span>
			</p></section><section class="section" id="config-ui-redis"><div class="titlepage"><div><div><h2 class="title">7.7. Redis configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-redis.png" alt="Redis configuration"/></span>
			</p></section><section class="section" id="config-ui-repo-mirroring"><div class="titlepage"><div><div><h2 class="title">7.8. Repository mirroring configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-repo-mirroring.png" alt="Repository mirroring configuration"/></span>
			</p></section><section class="section" id="config-ui-storage"><div class="titlepage"><div><div><h2 class="title">7.9. Registry storage configuration</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Proxy storage
					</li><li class="listitem">
						Storage georeplication
					</li><li class="listitem">
						Storage engines
					</li></ul></div><section class="section" id="config-ui-storage-georepl"><div class="titlepage"><div><div><h3 class="title">7.9.1. Enable storage replication - standalone Quay</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Scroll down to the section entitled <code class="literal">Registry Storage</code>.
						</li><li class="listitem">
							Click <code class="literal">Enable Storage Replication</code>.
						</li><li class="listitem">
							Add each of the storage engines to which data will be replicated. All storage engines to be used must be listed.
						</li><li class="listitem">
							If complete replication of all images to all storage engines is required, under each storage engine configuration click <code class="literal">Replicate to storage engine by default</code>. This will ensure that all images are replicated to that storage engine. To instead enable per-namespace replication, please contact support.
						</li><li class="listitem">
							When you are done, click <code class="literal">Save Configuration Changes</code>. Configuration changes will take effect the next time Red Hat Quay restarts.
						</li><li class="listitem"><p class="simpara">
							After adding storage and enabling “Replicate to storage engine by default” for Georeplications, you need to sync existing image data across all storage. To do this, you need to <code class="literal">oc exec</code> (or docker/kubectl exec) into the container and run:
						</p><pre class="screen"># scl enable python27 bash
# python -m util.backfillreplication</pre><p class="simpara">
							This is a one time operation to sync content after adding new storage.
						</p></li></ol></div></section><section class="section" id="config-ui-storage-engines"><div class="titlepage"><div><div><h3 class="title">7.9.2. Storage engines</h3></div></div></div><section class="section" id="local_storage_2"><div class="titlepage"><div><div><h4 class="title">7.9.2.1. Local storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-local.png" alt="Local storage configuration"/></span>
					</p></section><section class="section" id="amazon_s3_storage"><div class="titlepage"><div><div><h4 class="title">7.9.2.2. Amazon S3 storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-s3.png" alt="Amazon S3 storage configuration"/></span>
					</p></section><section class="section" id="azure_blob_storage"><div class="titlepage"><div><div><h4 class="title">7.9.2.3. Azure blob storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-azure.png" alt="Azure blob storage configuration"/></span>
					</p></section><section class="section" id="google_cloud_storage"><div class="titlepage"><div><div><h4 class="title">7.9.2.4. Google cloud storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-google.png" alt="Google cloud storage configuration"/></span>
					</p></section><section class="section" id="ceph_object_gateway_rados_storage"><div class="titlepage"><div><div><h4 class="title">7.9.2.5. Ceph object gateway (RADOS) storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-ceph.png" alt="Ceph object gateway (RADOS) storage configuration"/></span>
					</p></section><section class="section" id="openstack_swift_storage_configuration"><div class="titlepage"><div><div><h4 class="title">7.9.2.6. OpenStack (Swift) storage configuration</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-swift.png" alt="OpenStack (Swift) storage configuration"/></span>
					</p></section><section class="section" id="cloudfront_amazon_s3_storage_configuration"><div class="titlepage"><div><div><h4 class="title">7.9.2.7. Cloudfront + Amazon S3 storage configuration</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-storage-cloudfront.png" alt="Cloudfront + Amazon S3 storage configuration"/></span>
					</p></section></section></section><section class="section" id="config-ui-action-log"><div class="titlepage"><div><div><h2 class="title">7.10. Action log configuration</h2></div></div></div><section class="section" id="action_log_storage_configuration_2"><div class="titlepage"><div><div><h3 class="title">7.10.1. Action log storage configuration</h3></div></div></div><section class="section" id="database_action_log_storage"><div class="titlepage"><div><div><h4 class="title">7.10.1.1. Database action log storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-action-log-database.png" alt="Database action log storage configuration"/></span>
					</p></section><section class="section" id="elasticsearch_action_log_storage"><div class="titlepage"><div><div><h4 class="title">7.10.1.2. Elasticsearch action log storage</h4></div></div></div><p>
						<span class="inlinemediaobject"><img src="images/ui-action-log-elastic.png" alt="Elasticsearch log storage configuration"/></span>
					</p></section></section><section class="section" id="action_log_rotation_and_archiving"><div class="titlepage"><div><div><h3 class="title">7.10.2. Action log rotation and archiving</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-action-log-rotation.png" alt="Action log rotation and archiving configuration"/></span>
				</p><p>
					<span class="inlinemediaobject"><img src="images/ui-action-log-rotation-storage-choice.png" alt="Action log rotation and archiving storage choice"/></span>
				</p></section></section><section class="section" id="config-ui-security-scanner"><div class="titlepage"><div><div><h2 class="title">7.11. Security scanner configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-security-scanner.png" alt="Security scanner configuration"/></span>
			</p></section><section class="section" id="config-ui-app-registry"><div class="titlepage"><div><div><h2 class="title">7.12. Application registry configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-app-registry.png" alt="Application registry configuration"/></span>
			</p></section><section class="section" id="config-ui-email"><div class="titlepage"><div><div><h2 class="title">7.13. Email configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-email.png" alt="Email configuration"/></span>
			</p></section><section class="section" id="config-ui-internal-authentication"><div class="titlepage"><div><div><h2 class="title">7.14. Internal authentication configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-internal-authentication.png" alt="Internal authentication configuration"/></span>
			</p><p>
				<span class="inlinemediaobject"><img src="images/ui-internal-authentication-choice.png" alt="Internal authentication choice"/></span>
			</p><section class="section" id="ldap"><div class="titlepage"><div><div><h3 class="title">7.14.1. LDAP</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-auth-ldap.png" alt="LDAP authentication"/></span>
				</p></section><section class="section" id="keystone_openstack_identity"><div class="titlepage"><div><div><h3 class="title">7.14.2. Keystone (OpenStack identity)</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-auth-keystone.png" alt="Keystone authentication"/></span>
				</p></section><section class="section" id="jwt_custom_authentication"><div class="titlepage"><div><div><h3 class="title">7.14.3. JWT custom authentication</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-auth-jwt.png" alt="JWT custom authentication"/></span>
				</p></section><section class="section" id="external_application_token"><div class="titlepage"><div><div><h3 class="title">7.14.4. External application token</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-auth-external-app.png" alt="External application token authentication"/></span>
				</p></section></section><section class="section" id="config-ui-oauth"><div class="titlepage"><div><div><h2 class="title">7.15. External authentication (OAUTH) configuration</h2></div></div></div><section class="section" id="github_enterprise_authentication"><div class="titlepage"><div><div><h3 class="title">7.15.1. GitHub (Enterprise) authentication</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-oauth-github.png" alt="GitHub (Enterprise) authentication configuration"/></span>
				</p></section><section class="section" id="google_authentication"><div class="titlepage"><div><div><h3 class="title">7.15.2. Google authentication</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-oauth-google.png" alt="Google authentication configuration"/></span>
				</p></section></section><section class="section" id="config-ui-access-settings"><div class="titlepage"><div><div><h2 class="title">7.16. Access settings configuration</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-access-settings.png" alt="Access settings configuration"/></span>
			</p></section><section class="section" id="config-ui-dockerfile-build"><div class="titlepage"><div><div><h2 class="title">7.17. Dockerfile build support</h2></div></div></div><p>
				<span class="inlinemediaobject"><img src="images/ui-dockerfile-build.png" alt="Dockerfile build support"/></span>
			</p><section class="section" id="github_enterprise_build_triggers"><div class="titlepage"><div><div><h3 class="title">7.17.1. GitHub (Enterprise) Build Triggers</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-dockerfile-build-github.png" alt="GitHub (Enterprise) Build Triggers"/></span>
				</p></section><section class="section" id="bitbucket_build_triggers_2"><div class="titlepage"><div><div><h3 class="title">7.17.2. BitBucket Build Triggers</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-dockerfile-build-bitbucket.png" alt="BitBucket Build Triggers"/></span>
				</p></section><section class="section" id="gitlab_build_triggers_2"><div class="titlepage"><div><div><h3 class="title">7.17.3. GitLab Build Triggers</h3></div></div></div><p>
					<span class="inlinemediaobject"><img src="images/ui-dockerfile-build-gitlab.png" alt="GitLab Build Triggers"/></span>
				</p></section></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm45162230260800"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2022 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>